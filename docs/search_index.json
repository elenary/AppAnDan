[["index.html", "Прикладной анализ данных 1 Чек-лист работы с данными", " Прикладной анализ данных Елена Рыбина 2022-06-12 1 Чек-лист работы с данными Рассмотрим, как должен выглядеть чек-лист работы с данными для проверки себя, если бы эти экспериментальные данные мы собирали бы сами? —–Теоретический этап, планирование работы с данными—– Сформулированы теоретические гипотезы. Сформулированы эмпирические гипотезы (метод исследования, операционализированные ЗП и НП). Есть понимание, как будут выглядеть собранные данные. Выбраны уровень значимости и статистическая мощность. Выбран статистический метод проверки экспериментальной гипотезы (и хорошо, если есть понимание о статистической гипотезе – это уже про H0 и H1) Расчитан размер требуемой выборки (на уровне выбранной стат мощности и ожидаемого размера эффекта с применением выбранного метода). Выбрана среда для анализа данных и алгоритмы и пакеты для анализа. —–Данные собраны—– Данные предобработаны и приведены в вид, к которому можно применить выбранные статистические методы. Предобработанные переменные исследованы описательными статистиками и визуализированы для лучшего понимания данных. Проведен расчет выбранного статистического метода с помощью выбранной функции. Результаты визуализированы, так, чтобы их было легче правильно интерпретировать. Результаты проинтепретированы и сделан вывод относительно изначальной эмпирической гипотезы. Теперь пройдемся подробнее по некоторым из этих пунктов. В качестве примера возьмем датасет с kaggle https://www.kaggle.com/datasets/uciml/student-alcohol-consumption. Это – данные из двух португальских школ (скорее колледжей) с подробной социо-демографической информации о студентах, включая ту, как они учатся по математике и португальскому языку и как часто пьют алкоголь. Этот датасет я взяла, так как он содержит переменные разного типа данных в разных шкалах (и шкала отношений, например, возраст, и порядковая шкала, например, рейтинггования образования мамы или папы или поддержка в семье). studens_mat &lt;- read_csv(&quot;student-mat.csv&quot;) ## ## ── Column specification ──────────────────────────────────────────────────────── ## cols( ## .default = col_character(), ## age = col_double(), ## Medu = col_double(), ## Fedu = col_double(), ## traveltime = col_double(), ## studytime = col_double(), ## failures = col_double(), ## famrel = col_double(), ## freetime = col_double(), ## goout = col_double(), ## Dalc = col_double(), ## Walc = col_double(), ## health = col_double(), ## absences = col_double(), ## G1 = col_double(), ## G2 = col_double(), ## G3 = col_double() ## ) ## ℹ Use `spec()` for the full column specifications. studens_mat %&gt;% rename_with(., ~ paste0(., &quot;_mat&quot;), .cols = c(absences, paid, G1, G2, G3)) -&gt; studens_mat #переименовываю колонки для упрощения понимания, какие относятся к математикие kable(studens_mat[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) #визуализирую табличку для этой книжки school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 GP F 15 U LE3 T 1 1 at_home other other mother 1 2 3 yes no yes no yes yes yes no 4 3 2 2 3 3 10 7 8 10 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 studens_por &lt;- read_csv(&quot;student-por.csv&quot;) ## ## ── Column specification ──────────────────────────────────────────────────────── ## cols( ## .default = col_character(), ## age = col_double(), ## Medu = col_double(), ## Fedu = col_double(), ## traveltime = col_double(), ## studytime = col_double(), ## failures = col_double(), ## famrel = col_double(), ## freetime = col_double(), ## goout = col_double(), ## Dalc = col_double(), ## Walc = col_double(), ## health = col_double(), ## absences = col_double(), ## G1 = col_double(), ## G2 = col_double(), ## G3 = col_double() ## ) ## ℹ Use `spec()` for the full column specifications. studens_por %&gt;% rename_with(., ~ paste0(., &quot;_por&quot;), .cols = c(absences, paid, G1, G2, G3)) -&gt; studens_por kable(studens_por[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) #визуализирую табличку для этой книжки school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_por activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_por G1_por G2_por G3_por GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 4 0 11 11 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 2 9 11 11 GP F 15 U LE3 T 1 1 at_home other other mother 1 2 0 yes no no no yes yes yes no 4 3 2 2 3 3 6 12 13 12 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes no yes yes yes yes yes 3 2 2 1 1 5 0 14 14 14 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes no no yes yes no no 4 3 2 1 2 5 0 11 13 13 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes no yes yes yes yes no 5 4 2 1 2 5 6 12 12 13 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 13 12 13 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 2 10 13 13 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes no no yes yes yes no 4 2 2 1 1 1 0 15 16 17 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes no yes yes yes yes no 5 5 1 1 1 5 0 12 12 13 "],["теоретические-гипотезы.html", " 2 Теоретические гипотезы", " 2 Теоретические гипотезы Сформулированы теоретические гипотезы Возьмем первую придуманную гипотезу: в датасете есть студенты возрастов от 15 до 22 двух лет. Возможно, те, кто младше, будут бояться признаться в употрблении алкоголя и отвечать так, будто не употрябляют его. Они вляются несовершеннолетними и могут бояться, что родители узнают. Эта гипотеза хороша тем, что она имеет понятное теоретическое обоснование, она проверяема на наших данных, и данные подходят для того, чтобы ее проверить Вторая гипотеза: студенты с менее поддерживающими отношениями в семье чаще употребляют алкоголь. Эта гипотеза так же понятна, имеет теоретическое обосноование, проверяема в исследовании, и наши данные подходят для ее проверки. У меня была еще одна, третья гипотеза: что студенты, пропускающие много занятий, буду иметь более низкий средний балл по математике и португальскому. "],["эмпирические-гипотезы.html", " 3 Эмпирические гипотезы 3.1 Зависимые (ЗП) и независимые (НП) переменные в гипотезе 3.2 Типы шкал 3.3 Связь между ЗП и НП: какая она бывает? 3.4 Гипотезы о наличии линейной связи между НП и ЗП и гипотезы о разнице между группами по значению ЗП 3.5 Уровни НП в качественных переменных", " 3 Эмпирические гипотезы Сформулированы эмпирические гипотезы Эмпирические гипотезы – те, которые мы можем проверить опытным путем. Чтобы правильно их сформулировать, нам надо также определиться с типом эмпирического исследования, которое возможно для проверки наших теоретических гипотез. В психологических исследованиях это чаще всего эксперимент, квази-эксперимент, корреляционное исследование (и лонгитюдное исследование как его подвид). Иногды бывает case study, исследование одного конкретного случая, чаще в когнитивной психологии и нейронауках. В нашем случае все гипотезы рождены из одного заполнения опросника – значит, все, о чем мы можем говорить, это корреляции. Чуть позже поодробнее рассмотрим, почему, а пока попробуем сформулировать эмпирические гипотезы. Эмпирические гипотезы – это теоретические гипотезы, сформулированные в проверяемом для нашего исследования виде, то есть переведенные на язык исследования, исходя из наших предполагаемых переменных и их значений. В нашем случае теоретические гипотезы получились уже довольно конкретными, но давайте еще более точно операционализируем их и поясним, что в нашем исследовании мы будем иметь в виду под “много” или “мало”, какие переменные будут будем исследовать? Гипотеза 1 в контексте нашего исследования и существующих переменных может звучать так: студенты возраста 15-17 лет (age) при ответе на вопрос об употреблении алкоголя в выходные дни (Walc) будут выбирать варианты ответов, ассоциированные с как можно более редким употреблением - 1 или 2 Гипотеза 2 Студенты, кто оценивает отношения с родителями как менее поддерживающие (famrel, менее поддерживающие в значениях 1-2), чаще употребляют алкоголь (Walc, употребление в выходные дни, значения 4-5) Гипотеза 3 Студенты, у кого было много пропусков (absences_mat или absences_por, высокие значения), будут иметь более низкий средний балл (среднее из G1_mat, G2_mat, G3_mat или G1_por, G2_por, G3_por -- низкие значения) Давайте сначала подумаем, что это за гипотезы, какие зависимые и независимые переменные, наличие или отсутствие какой связи между зависимой и независимыми переменными нам хочется проверить? 3.1 Зависимые (ЗП) и независимые (НП) переменные в гипотезе Рассмотрим гипотезу 1. Что в ней является зависимой и независимой переменной? Сейчас гипотеза сформулирована так, что НП – это возраст (age), а ЗП – это количество употребления алкоголя Walc. Согласны ли вы с таким разделением? Почему? Иногда бывает сложно определить, что будет являться зависимой и независимыми переменными. Независимые переменные – это все, чем мы манипулируем по ходу проведения исследования, с целью получить разный результат. Зависимая – целевая переменная, то, что мы измереяем, изменения в чем мы ожидаем получить после манипуляции независимыми переменными. При описании исследования всегда важно записывать ЗП и НП, наряду с экспериментальной (эмпирической) гипотезой – сердце нашего исследования, самое основное из языка, на котором описывается исследование. Следующий вопрос – к какой шкале относятся ЗП и НП? Это важно понимать, чтобы потом выбрать, как анализировать данные. 3.2 Типы шкал Шкала Описание Возможные операции Примеры Наименований (номинальная) Качественная (категориальная), нельзя установить “больше” или “меньше” =, \\(\\neq\\) shcool, sex, address, famsize, Mjob, Fjob, schoolsup Порядка (ранговая) Качественная (категориальная), можно установить “больше” или “меньше”, но нельзя посчитать количественно, на сколько больше или меньше =, \\(\\neq\\), &gt;, &lt; Medu, Fedu, traveltime, studytime, famrel, freetime, goout, Dalc, Walc, health Разности (интервальная) Количественная, но нет абсоолютного нуля, можно посчитать на сколько больше или меньше, но нельзя посчитать, во сколько раз =, \\(\\neq\\), &gt;, &lt;, +, - G (отнесу сюда, так как с оценками все сложно) Отношений (абсолютная) Количественная, есть абсолютный ноль, можно посчитать и на сколько больше или меньше, и во сколько раз =, \\(\\neq\\), &gt;, &lt;, +, -, ×, ÷ age, failures, absences Опишем переменные для гипотезы 1. Возраст (age) – это количественная переменная, в целом про возраст мы можем сказать, что он непрерывен (здесь возраст округлен до целых, поэтому на которотком промежутке возрастов это может сыграть роль) Чуть позже посмотрим на переменную возраста в описательных статистиках, чтобы убедиться, что можем работать с ней как с непрерывной переменной. У возраста есть абсолютный ноль (нельзя быть возраста “-10 лет”), можем сказать, что человек возраста 30 лет в два раза старше человека возраста 15 лет, поэтому возраст относится к шкале отношений. Walc – явно относится к порядковой шкале: можем сказать, что студенты, ответившие “4” на вопрос про употребление алкоголя, употребляют его больше, чем те, кто выбрал “2”, но не можем сказать, что в количестве выпитого алкоголя эта разница выражается как в два раза больше. К каким шкалам относятся переменные для гипотезы 2 и гипотезы 3? 3.3 Связь между ЗП и НП: какая она бывает? Сейчас гипотезы 1 - 3 сформулированы так: студенты возраста 15-17 лет (age) при ответе на вопрос об употреблении алкоголя в выходные дни (Walc) будут выбирать варианты ответов, ассоциированные с как можно более редким употреблением - 1 или 2 Студенты, кто оценивает отношения с родителями как менее поддерживающие (famrel, менее поддерживающие в значениях 1-2), чаще употребляют алкоголь (Walc, употребление в выходные дни, значения 4-5) Студенты, у кого было много пропусков (absences_mat или absences_por, высокие значения), будут иметь более низкий средний балл (среднее из G1_mat, G2_mat, G3_mat или G1_por, G2_por, G3_por -- низкие значения) Мы выяснили, что в первой гипотезе НП – это возраст (age), а ЗП – это количество употребления алкоголя Walc. Во второй гипотезе НП – оценка отношений с родителями (famrel), и та же ЗП (Walc). То есть, разворачивая такую формулировку, мы считаем, что возраст и качество отношений в семье влияет на ответы. Если смотреть на данные, выводы о какой связи мы можем установить? Два основных вида связи между переменными: Ассоциативная или корреляционная Причинно-следственная Три необходимых условия для установления причинно-следственной связи: Изменение НП произошло раньше, чем мы пронаблюдали изменение в ЗП Изменения НП имеют ассоциативную связь с изменениямм в ЗП Нет никаких альтернативных объяснений изменений в ЗП, помимо изменений НП Сейчас у нас есть только опросные данные, в которых студенты отвечали на вопросы одновременно. Получается, что в таком дизайне исследования мы не проходим необходимые условия для установления причинно-следственной связи, следовательно, сделать вывод о причинно-следственной связи не можем. Причинно-следственную связь мы можем установить только в ходе эксперимента или квази-эксперимента (отличается от эксперимента тем, что испытуемые не распределяются в группы рандомно, а используются уже существующие в популяции группы, например, разные страны). Во всех остальных видах исследований, особенно, когда исследуется связь переменных в одном самоотчете или опроснике, мы можем говорить только об ассоциативной или корреляционной связи. Важно отметить, что вполне возможно, на самом деле в популяции эта связь и будет причинно-следственной. Вполне вероятно, что плохие отношения в семье приводят у алкоголизму у детей. Но у нас в нашей выборке есть только такие данные – из опросника, и из тех данных того исследования, которые у нас есть, мы можем судить только о наличии или отсутствии корреляции. При формулировании выводов эти выводы могут отличаться так, сравните: - Вывод 1: “Менее поддерживающие отношения в семье вызывают алкоголизм”. - Вывод 2: “Менее поддерживающие отношения в семье ассоциированы с высоким риском алкоголизма”. Несмотря на то, что мы говорим о корреляции, тут тоже есть варианты. Сравните варианты формулировок для гипотезы 1: чем меньше возраст студентов (age), чем ниже будут ответы в переменной Walc и студенты возраста 15, 16, 17 лет будут выбирать меньшие варианты ответа в переменной Walc или студенты возраста 15 лет будут выбирать меньшие варианты ответа в переменной Walc. Чем они отличаются? 3.4 Гипотезы о наличии линейной связи между НП и ЗП и гипотезы о разнице между группами по значению ЗП Первый вариант этой гипотезы – это гипотеза о наличии ассоциативной (корреляционной) связи между ЗП и НП: чем больше / меньше значение НП, тем больше / меньше значение ЗП. Здесь для гипотезы нам важно, что увеличение НП на каждый произвольный интервал будет вызывать какие-то пропорциональные изменения в каждом таком же интервале ЗП. Второй и третий варианты подразумевают сравнения групп по какому-либо параметру центральной тенденции (среднее, медиана, мода) ЗП. Чаще всего, когда речь идет о сравнении групп, сравниваются средние значения ЗП в этих группах (в т-тестах, тестах Уилкоксона и Манна-Уитни, и даже в дисперсионном анализе АНОВА на самом деле сравниваются не дисперсии, а средние). Здесь мы выделяем группы: “студенты младше 18 лет” и “студенты 18 лет и старше”, или “студенты возраста 15 лет” и “студенты возраста НЕ 15 лет”. От этого, хотим мы проверить наличие или отсутствие линейной связи между переменными или сравнить средние значения в нескольких группах, будет так же зависеть выбор статистичекого метода для проверки гипотезы. Вернемся к этому в разделе [Выбор статистического метода, уровня значимость и статистической мощности (статистики вывода)] 3.5 Уровни НП в качественных переменных Об уровнях в НП говорят в категориальных (порядковых или номинативных), качественных переменных. Например, условия “часто” и “редко”, условия “обеспеченная семья” или “не обеспеченная”. В примерах выше для гипотезы чем меньше возраст студентов (age), чем ниже будут ответы в переменной Walc мы не можем выделить уровни НП, ЗП непрерывная, тем более, это гипотеза о наличи линейной связи между переменными, связи каждого значения НП с каждым значением ЗП, уровни тут невозможны. Однако в гипотезе студенты возраста 15, 16, 17 лет будут выбирать меньшие варианты ответа в переменной Walc мы собираемся сравнить две группы, и здесь можно говорить об уровнях НП age – “студенты младше 18 лет” и “студенты 18 лет и старше”. Чтобы это сделать, нам нужно будет перекодировать переменную age в новую, категориальную переменную, со значениями “младше 18 лет” и “18 и старше”, сделаем это в разделе Препроцессинг. "],["представление-о-собранных-данных.html", " 4 Представление о собранных данных", " 4 Представление о собранных данных Есть понимание, как будут выглядеть собранные данные Итак, мы подробно разобрались, какие у нас гипотезы. Теперь можно подумать о том, как будут выглядеть собранные данные для проверки этих гипотез. Здесь мы работаем с уже готовым датасетом, поэтому понимание о собранных данных у нас есть. Но в реальной жизни прежде, чем начинать сбор данных, нужно хорошо представлять себе, как будут записываться данные: это логи в текстовом файле, и нам нужно будет вручную выковыривать их него цифры и собирать табличку? Если да, можно ли это автоматизировать? Или это эксель-табличка, в которую данные будут писаться в уже пригодном для работы виде? Если нет, можем ли мы сделать так, чтобы данные писались в такую удобную табличку, еще на этапе кодирования эксперимента? Этот самый момент, когда мы уже определили гипотезы и отправляемся разрабатывать дизайн эксперимента и кодировать его в PsychoPy или другой среде. До запуска эксперимента нужно будет понимать, как мы будем собирать данные, как они будут выглядеть, сможем ли мы сделать с ними все, что хотим, применить нужный статистический метод? "],["выбор-уровня-значимости-и-статистической-мощности.html", " 5 Выбор уровня значимости и статистической мощности 5.1 Проверка статистических гипотез (NHST, Null Hypothesis Statistical Testing) 5.2 Выбор уровня значимости и статистической мощности", " 5 Выбор уровня значимости и статистической мощности Выбраны вероятностные рамки, в которых будет проводиться тестирование гипотезы: уровень значимости и статистическая мощность. До кодирования эксперимента или в начале кодирования мы так же определеяем, какие статистические методы будем использовать для проверки гипотез. Сейчас, в случае с уже готовым дататестом, все не совсем так, и мы на уже готовом датасете пытаемся восстановить изначальные гипотезы, для проверки которых этот датасет собирался. Вообще пытаться прикрутить гипотезу к уже собранным данным – это плохая научная практика, которая приводит к большому числу ложноположительных результатов. Об этом мы подробно поговорим в теме Questionable and good research practices. Раздел статистики, который относится к установлению выводов относительно взаимосвязи между переменными в популяции (генеральной совокупности) по данным нашей небольшой выборки, ровно так и называется: статистический вывод, или inferential statistics. Наша цель в статистическом выводе – имея данные только нашего небольшого исследования получить ответы на вопросы относительно всей популяции: связаны ли незавасимые и зависимая переменные в популяции между собой, и если да, то как? Выделяются ли группы в популяции между собой по значением зависимой переменной, и если да – обусловлены или эти изменения варьированием нашей независимой переменной? Для этого нам нужно выбрать статистический метод, которым мы будем проверять гипотезу, и условия, в которых он прооводится: уровень значимости и статистическую мощность. 5.1 Проверка статистических гипотез (NHST, Null Hypothesis Statistical Testing) Давайте немного разберемся, что проиходит, когда мы применяем какой-либо статистический метод для проверки гипотез (т-тест, Уилкоксона или Манна-Уитни, АНОВА, линейная регрессия, логистическая регрессия и тд). Что вообще мы имеем в виду под проверкой гипотез? У нас есть какое-то предположение о том о связи неких психологических конструктов относительно того, как работает психика у людей в целом (теоретическая гипотеза). Мы придумываем дизайн исследования и уточняем уже эмпирическую гипотезу на языке исследования, делаем ее более конкретной, операционализируем наши конструкты. Далее проводим исследование и собираем данные на нашей выборке, часто не очень большой (обычно размер выборки варьируется от 30 до 100 человек, подробнее обсудим при рассмотрении статистической мощности). Проводим расчет статистического метода и делаем вывод по эмпирической гипотезе о связи наших конструктов, в том смысле, в котором мы их операционализировали. И когда мы делаем выводы, мы говорим не о нашей небольшой группе людей, которых мы исследовали – а о всей популяции людей, она называется генеральной совокупностью. Почему так можно? Изображение с https://towardsdatascience.com/ Собственно, за это и отвечает математика и теория вероятностей, заложенные внутрь статистических тестов. Мы предполагаем, что люди, участвующие в нашем исследовании – рандомные представители генеральной совокупности (ха-ха, так, конечно, никогда не бывает, но воообще важно, чтобы то, что мы исследуем только русскоязычных людей или студентов психфака не влияло на нашу зависимую переменную). И когда мы применяем статистический метод, мы оцениваем, какова вероятность, при условии, что мы выбрали случайных людей, получить такие результаты о связи НП и ЗП во всей генеральной совокупности? Когда мы проводим расчет статистического метода, мы получаем несколько цифр, одна из них, про которую все наверняка уже слышали и к которой часто формируется благовейный трепет – p-value. На самом деле, это только одна из связки цифр, которые нужны нам для точного статистического вывода, сама по себе в вакууме она бессмысленна. Но в связке с другими цифрами она дает нам возможность понять, какова вероятность (p for probability) получить результат, который мы получили, в генеральной совокупности? И если по условиям теста полученная вероятность нас устраивает, мы делаем вывод. Пройдемся подробнее по шагам этого вывода. Алгоритм NHST Формулируем эмпирическую гипотезу (это мы уже сделали выше) Формулируем нулевую \\(H_0\\) и альтернативную \\(H_1\\) гипотезы. Для того, чтобы провести статистический тест, нужно определить еще статистическую гипотезу – тестируемое утверждение об отсутствии различий между группами (если гипотеза подразумевает сравнение групп) или об отсутствии связи между переменнами (если гипотеза про связь). Это \\(H_0\\), нулевая гипотеза, которую мы пытаемся опровергнуть в статистическом тестировании (да, именно опровергнуть, а не подтвердить – выводы, которые мы можем сделать отноосительно нулевой гипотезы – только отвергнуть или не отвергнуть, не можем подтвердить ее и принять). Противоположная к нулевой гипотезе – альтернативная гипотеза, \\(H_1\\). Это статистическая гипотеза, противоположная \\(H_0\\), о разнице между группами или о наличии связи. Удобно, когда она тоже сформулирована, чтобы всем придерживаться одного языка статистических тестов. Выбираем условия, при котором будем рассчитывать статистический критерий – уровень значимости и статистическую мощность. Уровень значимости \\(\\alpha\\) – вероятность получить случайный результат, если на самом деле его нет, чаще всего α = 0.05, и \\(power\\), вероятность того, что если в популяции есть эффект, мы найдем его она данных. \\(power\\) = \\(1 - \\beta\\), где \\(\\beta\\) – вероятность случайно не получить результат, если на самом деле он есть. Чаще всего \\(power = 0.8\\). К этому мы перейдем сразу в следующем подразделе Выбор уровня значимости и статистической мощности Выбираем статистический критерий для проверки (t-test, Wilcoxon/Mann–Whitney–test, ANOVA, lm) – этому посвящен следующий подраздел [Выбор статистических методов для разных гипотез]. Считаем размер выборки Сколько данных нужно собрать при выбранном статистическом тесте и ожидаемом размере эффекта, выбранном уровне значимости \\(\\alpha\\) и выбранной статистической мощности \\(power\\) – рассмотрим в следующем подразделе [Расчет размера выборки на основании статистической мощности, уровня значимости и статистического критерия] Проводим выбранный выбранный статистический тест – получаем статистику (например, t-значение, F-значение, R – коэффициент корреляции или процент объясненной дисперсии) и p-value. Делаем вывод: сравниваем p-value с выбранным уровнем значимости α, считаем размер эффекта 5.2 Выбор уровня значимости и статистической мощности Уровень значимости \\(\\alpha\\) и статистическая мощность \\(power\\) – это два их самых важных параметров в тестировании гипотез. Эти понятия задают вероятностные рамки, в которых мы будем проводить тест. Первая рамка – это вероятность получить значимый результат (различия или связь), если его на самом нет в генеральной совокупности – ложноположительный результат, false positive, она же ошибка первого рода \\(\\alpha\\). Вторая рамка – вероятность получить незначимый результат, если его на самом деле нет в генеральной совокупности – ложноотрицательный результат, false negative, она же ошибка второго рода \\(\\beta\\). Скорее всего, вы уже сталкивались с такой таблицей: Другой популярный вариант для объяснения ошибок первого и второго рода: Вероятность, при которой в генеральной совокупности нет разницы между группами или связи, но мы получили ее на наших данных – это и есть уровень значимости \\(\\alpha\\) , который мы задаем сами (!). А вероятность, при которой в генеральной совокупности на самом деле есть разница между группами или связь, но мы не получили ее на наших данных – это \\(\\beta\\) = 1 - статистическая мощность теста. Уровень значимости \\(\\alpha\\) – это уровень вероятности, при достижении которого мы будем считать, что нулевая гипотеза \\(H_0\\) подтвердилась, и значимых различий или связи между переменными нет. Это просто значение из пространства вероятностей получить значимый результат случайным образом, при условии, что его на самом деле нет в генеральноой совокупности. Психологи просто выбрали значение \\(\\alpha = 0.05\\) и решили, что 5% ложноположительных результатов в психологии – подходящий вариант (сейчас идет большая дискуссия, так ли это). А если мы возьмем, например, физику элементарных частиц, то здесь речь об открытии новой частиц идет только на уровне \\(\\alpha = 0.000001\\)! Уровень статистической мощности (statistical power) – это положительная метрика, уровень вероятности, при котором мы гарантируем, что если различия между группами или связь между переменными есть в генеральной совокупности, то мы сможем найти ее на наших данных при помощи нашего статистического теста. Если смотреть на таблицу ошибок первого и второго, статистическая мощность это \\(1 - \\beta\\), то есть обратная величина к вероятности ошибки второго рода, не найти значимый эффект, если он есть \\(\\beta\\) (статистическая мощность и вероятность ошибки второго рода – противоположные понятия, в суммме эти вероятности дают 1). В психологии конвенционально сложилось, что чаще всего статистическую мощность принимают на уровне \\(power = 0.8\\) "],["выбор-статистического-метода.html", " 6 Выбор статистического метода", " 6 Выбор статистического метода Исходя из гипотезы и того, как будут собраны и какие это данные, выбран статистический метод проверки экспериментальной гипотезы Следующий шаг, с которым надо надо определиться – выбрать метод для тестирования наших гипотез. Посмотрим на гипотезы. Гипотезу 1 мы сводили к нескольким вариантам: a) \"студенты возраста 15, 16, 17 лет будут выбирать меньшие значения переменной Walc, чем студенты 18 лет и старше\" b) \"студенты возраста 15 лет будут выбирать меньшие значения переменной Walc, чем студенты 16 лет и старше Как можно их проверить? Это звучит как тест-сравнение двух или нескольких средних по позрастам, 15-17 лет и 18-22 (первый вариант) и 15 лет и 16-22 года (второй вариант). Гипотезу 2 будем проверять в виде: Чем ниже студенты оценивают качества семейных отношений famrel, тем выше они отмечают частоту употребления алкоголя Walc Здесь у нас нет групп, мы проверяем гипотезу о наличии связи между переменными (условно – чем больше значение НП, тем больше или меньше значение ЗП, с ростом НП также происходят изменения и в ЗП) Гипотеза 3: Студенты, у кого было много пропусков (переменная absences_mat или absences_por, высокие значения), будут иметь более низкий средний балл (среднее из переменных G1_mat, G2_mat, G3_mat или G1_por, G2_por, G3_por -- низкие значения) Как понять, какой тест выбрать? Это, наверное, один из самых сложных вопросов в статистике. Вопросы, которые влияют на принятие решения относительно статистического теста: Зависимая переменная непрерывная (интервальная шкала или шкала отношений) или категориальная / дискретная (номинативная или порядковая шкала)? Если ЗП непрерывная – она описывается параметрическим (чаще всего нормальным) распределением? (определяется чаще “на глаз” по графику плотности вероятности или QQ-графиками, тесты на нормальность почти всегда будут давать негативный результат из-за чувствительности и поэтому в современном анализе данных используются мало) Сколько независимых переменных? НП непрерывные (интервальная и шкала отношений) или категориальные / дискретные (номинативная и порядковая)? Если НП категориальные и мы сравниваем группы – данные в группах зависимы или нет? Если нет, как сильно отличаются данные в группах, можем ли сказать, что дисперсия ЗП примерно одинакова в группах или нет? (равенство дисперсий называется Homogeneity of Variance, проверяется с помощью Levene’s test) Есть большое количество схем, но обычно они сильно перегруженны и сложны в использовании, больше путают, чем помогают. Но я зачем-то все равно решила попробовать нарисовать свою, и вот результат: https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470 Здесь не все возможные методы статистической проверки гипотез. Однако, скорее всегоо, тут отображены большинство методов, которые могут вам понадобиться в психологических исследованиях. Надеюсь, вы сможете разобраться, и вам будет полезно Эти же методы списком: ЗП количественная, непрерывная, и одна НП, количественная, непрерывная – корреляция Пирсона (Pearson correlation) или линейная регрессия (linear regression). ЗП количественная, непрерывная, и две и более НП, количественные, непрерывные – множественная линейная регрессия (multiple linear regression). ЗП количественная, непрерывная, и параметрическая, и одна НП, категориальная, дискретная. Группы НЕзависимые – independent t-test. ЗП количественная, непрерывная, и параметрическая, и одна НП, категориальная, дискретная. Группы зависимые – paired t-test. ЗП порядковая или НЕпараметрическая, и одна НП, категориальная, дискретная или количественная, непрерывная. Ассоциативная связь – корреляция Спирмена (Spearman correlation). Если группы, НЕзависимые – Mann-Whitney test. ЗП порядковая или НЕпараметрическая, и одна НП, категориальная, дискретная или количественная, непрерывная. Ассоциативная связь – корреляция Спирмена (Spearman correlation). Если группы, зависимые – Wilcoxon test. ЗП количественная, непрерывная, и параметрическая, и две и более НП, категориальные, дискретные. Группы НЕзависимые – ANOVA. ЗП количественная, непрерывная, и параметрическая, и две и более НП, категориальные, дискретные. Группы зависимые – repeated-measurment ANOVA. ЗП порядковая или НЕпараметрическая, и две и более НП, категориальные, дискретные. Группы независимые – Kruskal-Wallis test. ЗП порядковая или НЕпараметрическая, и две и более НП, категориальные, дискретные. Группы зависимые – Friedman test. ЗП категориальная, может принимать два значения, и одна НП, количественная, непрерывная – логистическая регрессия (logistic regression) ЗП категориальная, может принимать два значения, и две и более НП, количественные, непрерывные – множественная логистическая регрессия (multiple logistic regression) ЗП категориальная, может принимать два значения, и одна НП, категориальная, дискретная. Группы НЕзависимые – Fisher’s test (Chi-square test). ЗП категориальная, может принимать два значения, и одна НП, категориальная, дискретная. Группы зависимые – McNemar’s test. ЗП категориальная, может принимать БОЛЕЕ двух значениq, и одна или более НП, количественных, непрерывных – мультиномиальная логистическая регрессия (Multinomial logistic regression, multivariate logistic regression) В целом, если разобраться в тестах не получилось, ответы на эти вопросы помогают сформировать запрос и дальше отправиться в гугл или к коллегам с конкретным вопросом, например какой тест использовать для сравнения двух независимых групп в количественной шкале? Я подразумевала, что можно почитать статьи из поисковой выдачи, но оказалось, что гугл даже научился иногда отвечать на этот вопрос… "],["расчет-размера-выборки.html", " 7 Расчет размера выборки", " 7 Расчет размера выборки После того, как мы выбрали уровень значимости, уроовень статистической мощности и статистический критерий, который мы будем использовать для проверки гипотезы, нам нужно рассчитать, сколько наблюдений нужно набрать, чтобы сделать точный вывод с учетом всех выбранных нами допущений и вероятностей относительно ложнооположительного и ложноотрицательного вывода? Этот пункт раньше часто пропускался: казалось, что размер выборки не требует определенного расчета, и достаточно опираться на предыдущие исследование. Оказалось, что это не так, подробнее о последствиях такого подхода в следующем подразделе Questionable and good research practices. Размер выборки неразрывно связан с тремя другими параметрами: статистической мощностью (чаще всего выбираем на уроовне 80%), уровня значимости и размера эффекта. Он рассчитывается на основании статистической мощности, уровня значимости и ожидаемого размера эффекта выбранного статистического критерия Размер эффекта – это величина наблюдаемых различий. За степень различий отвечает не полученная статистика после примененного статистического критерия (например, t-значение, F-значение), и не p-значение, а отдельная метрика. Эта метрика расчитывается по формулам индивидуально для каждого статистического теста. Например, для t-testа размер эффекта – это Cohen’s d. В психологических исследованиях размер эффекта редко бывает большим. И чем меньше ожидаемый размер эффекта, тем больше наблюдений нам надо собрать для возможности сделать точный вывод о наличи или отсутствии различий в генеральной совокупности. Зная статистическую мощность, уровень значимости и размер эффекта – размер выборки можно рассчитать в Gpower https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower или в R, например, с помощью пакета pwr https://cran.r-project.org/web/packages/pwr/pwr.pdf Для того, чтобы детально поразбираться в нюансах размера эффекта и выборки, можно пройти курс Лакенса https://www.coursera.org/learn/statistical-inferences (кажется, только с vpn) "],["выбор-среды-анализа-данных.html", " 8 Выбор среды анализа данных", " 8 Выбор среды анализа данных Выбрана среда для анализа данных и конкретная функция под выбранный статистический критерий (или несколько функций) (если нужно - установлен пакет для выбранных функций) Как вы уже догадались, я обрабатываю данные в R. Этот сайт, кстати, тоже сделан на языке R в RStudio с помощью текстовой разметки RMarkdown. Об этом мы тоже немного поговорим на последнем семинаре, когда будем говорить про презентации результатов "],["препроцессинг.html", " 9 Препроцессинг", " 9 Препроцессинг Собранные данные предобработаны и приведены в вид, к которому можно применить выбранный статистический критерий и выполнить выбранную функцию Ура, наконец-то мы на этапе, где уже собраны данные! Я немного предобработаю их, чтобы дальше было проще с ними работать. Не недооценивайте предобработку: опытные аналитики говорят, что примерно 80%-90% анализа данных составляет предобработка, и только оставшееся – собственно вычисление ключевой функции (статистического критерия) и получение целевой цифры. studens_mat %&gt;% full_join(studens_por, by = c(&quot;school&quot;,&quot;sex&quot;,&quot;age&quot;,&quot;address&quot;,&quot;famsize&quot;,&quot;Pstatus&quot;,&quot;Medu&quot;,&quot;Fedu&quot;, &quot;Mjob&quot;,&quot;Fjob&quot;,&quot;reason&quot;, &quot;guardian&quot;, &quot;traveltime&quot;,&quot;studytime&quot;, &quot;failures&quot;, &quot;schoolsup&quot;, &quot;famsup&quot;, &quot;activities&quot;, &quot;nursery&quot;, &quot;higher&quot;, &quot;internet&quot;, &quot;romantic&quot;, &quot;famrel&quot;, &quot;freetime&quot;, &quot;goout&quot;, &quot;Dalc&quot;, &quot;Walc&quot;, &quot;health&quot;)) -&gt; students #объединяю две таблички в одну students %&gt;% mutate(&quot;student&quot; = paste0(&quot;id&quot;, row_number()), .before = &quot;school&quot;) -&gt; students #добавляю колонку с айдишником и перезаписываю результат в датасет students %&gt;% drop_na() -&gt; students #пропускаю строки с NA и перезаписываю результат в датасет students %&gt;% mutate(G_mat = rowMeans(select(., c(G1_mat, G2_mat, G3_mat))), G_por = rowMeans(select(., c(G1_por, G2_por, G3_por)))) -&gt; students kable(students[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) #здесь я посчитала средний балл по трем баллам по математике G_mat и португальскому G_por student school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat paid_por absences_por G1_por G2_por G3_por G_mat G_por id1 GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 no 4 0 11 11 5.666667 7.333333 id2 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 no 2 9 11 11 5.333333 10.333333 id4 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 no 0 14 14 14 14.666667 14.000000 id5 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 no 0 11 13 13 8.666667 12.333333 id6 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 no 6 12 12 13 15.000000 12.333333 id7 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 no 0 13 12 13 11.666667 12.666667 id8 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 no 2 10 13 13 5.666667 12.000000 id9 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 no 0 15 16 17 17.666667 16.000000 id10 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 no 0 12 12 13 14.666667 12.333333 id11 GP F 15 U GT3 T 4 4 teacher health reputation mother 1 2 0 no yes yes no yes yes yes no 3 3 3 1 2 2 0 10 8 9 no 2 14 14 14 9.000000 14.000000 "],["описательные-статистики-и-визуализации.html", " 10 Описательные статистики и визуализации 10.1 Таблицы и пропорции 10.2 Описательные визуализации 10.3 Визуализации статистического вывода, которые тоже помогают понять данные 10.4 Визуализации в R с помощью ggplot2 10.5 Визуализации данных в системах для построения дашбордов", " 10 Описательные статистики и визуализации Выбранные для анализа предобработанные переменные исследованы описательными статистиками и предварительно визуализированы для общего понимания) Теперь давайте поизучаем данные. Как ведут себя выбранные для анализа переменные? Что это за данные: в какой шкале они записаны, непрерывные или дискретные? Каковы максимальные и миниамальные значения? А самые встречающиеся? Какова вообще встречаемость разных значений? Такое описание данных называется описательными статистиками (descipritve stats), потому что, как уже понятно из названия, описывает наши данные. Это идет в разрез со статистиками вывода (inferential stats), когда мы делаем выводы относительно гипотез – сравнение двух выборок с определением статистической значимости результатов, корреляционный тест, определение коэффциентов в линейной регрессии и так далее. Сейчас нас интересует исследование самих переменных, поэтому речь здесь пойдет об описательных статистиках. 10.0.1 Описательные статистики Переменные, которые нас интересовали – для одной гипотезы это возраст (Age) и употребление алкоголя на выходных (Walc), для другой – отношения в семье (famrel) и употребление алкоголя в рабочие дни (Dalc). Рассмотрим их подробнее. И еще дл summary(students$age) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 15.00 16.00 16.00 16.52 17.00 22.00 Более детальный способ – с помощью дополнительных пакетов, например, Skimr и функции skim skimr::skim(students$age) Table 10.1: Data summary Name students$age Number of rows 320 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 0 1 16.52 1.14 15 16 16 17 22 ▇▅▃▁▁ skimr::skim(students) Table 10.1: Data summary Name students Number of rows 320 Number of columns 41 _______________________ Column type frequency: character 19 numeric 22 ________________________ Group variables None Variable type: character skim_variable n_missing complete_rate min max empty n_unique whitespace student 0 1 3 5 0 320 0 school 0 1 2 2 0 2 0 sex 0 1 1 1 0 2 0 address 0 1 1 1 0 2 0 famsize 0 1 3 3 0 2 0 Pstatus 0 1 1 1 0 2 0 Mjob 0 1 5 8 0 5 0 Fjob 0 1 5 8 0 5 0 reason 0 1 4 10 0 4 0 guardian 0 1 5 6 0 3 0 schoolsup 0 1 2 3 0 2 0 famsup 0 1 2 3 0 2 0 paid_mat 0 1 2 3 0 2 0 activities 0 1 2 3 0 2 0 nursery 0 1 2 3 0 2 0 higher 0 1 2 3 0 2 0 internet 0 1 2 3 0 2 0 romantic 0 1 2 3 0 2 0 paid_por 0 1 2 3 0 2 0 Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist age 0 1 16.52 1.14 15 16 16.00 17.00 22.00 ▇▅▃▁▁ Medu 0 1 2.87 1.07 0 2 3.00 4.00 4.00 ▁▂▆▅▇ Fedu 0 1 2.62 1.09 0 2 3.00 4.00 4.00 ▁▅▇▇▇ traveltime 0 1 1.43 0.69 1 1 1.00 2.00 4.00 ▇▃▁▁▁ studytime 0 1 2.08 0.87 1 1 2.00 3.00 4.00 ▅▇▁▃▁ failures 0 1 0.08 0.39 0 0 0.00 0.00 3.00 ▇▁▁▁▁ famrel 0 1 3.99 0.89 1 4 4.00 5.00 5.00 ▁▁▂▇▅ freetime 0 1 3.20 0.97 1 3 3.00 4.00 5.00 ▁▃▇▆▂ goout 0 1 3.07 1.10 1 2 3.00 4.00 5.00 ▂▆▇▅▃ Dalc 0 1 1.44 0.88 1 1 1.00 2.00 5.00 ▇▂▁▁▁ Walc 0 1 2.22 1.26 1 1 2.00 3.00 5.00 ▇▅▃▂▁ health 0 1 3.52 1.42 1 3 4.00 5.00 5.00 ▃▂▅▃▇ absences_mat 0 1 5.41 7.84 0 0 4.00 7.25 75.00 ▇▁▁▁▁ G1_mat 0 1 11.29 3.20 5 9 11.00 14.00 19.00 ▃▇▇▅▂ G2_mat 0 1 11.18 3.67 0 9 11.00 14.00 19.00 ▁▂▇▇▂ G3_mat 0 1 11.04 4.30 0 9 11.00 14.00 20.00 ▁▃▇▆▂ absences_por 0 1 3.25 4.56 0 0 2.00 4.00 32.00 ▇▁▁▁▁ G1_por 0 1 12.39 2.56 0 11 12.00 14.00 19.00 ▁▁▅▇▂ G2_por 0 1 12.57 2.42 5 11 12.00 14.00 19.00 ▁▃▇▅▁ G3_por 0 1 12.88 2.89 0 11 13.00 15.00 19.00 ▁▁▅▇▃ G_mat 0 1 11.17 3.56 2 9 11.00 13.67 19.33 ▁▃▇▅▂ G_por 0 1 12.62 2.51 4 11 12.67 14.33 18.67 ▁▂▇▆▂ 10.1 Таблицы и пропорции table(students$age, students$Walc) ## ## 1 2 3 4 5 ## 15 43 11 10 5 2 ## 16 37 20 12 14 8 ## 17 24 20 24 12 7 ## 18 23 18 13 8 2 ## 19 1 2 3 0 0 ## 22 0 0 0 0 1 round(prop.table(table(students$age, students$Walc), 1), 2) ## ## 1 2 3 4 5 ## 15 0.61 0.15 0.14 0.07 0.03 ## 16 0.41 0.22 0.13 0.15 0.09 ## 17 0.28 0.23 0.28 0.14 0.08 ## 18 0.36 0.28 0.20 0.12 0.03 ## 19 0.17 0.33 0.50 0.00 0.00 ## 22 0.00 0.00 0.00 0.00 1.00 10.2 Описательные визуализации Какой график построить для исследования данных внутри одной переменной? Гистограмма Если переменная количественная и дискретная или строковая – гистограмму (частота встречаемости отдельных значений). hist(students$Walc) students %&gt;% ggplot(aes(x=Walc)) + geom_histogram(binwidth = 0.5) + theme_minimal() Другой вариант визуализации гистограммы – с помощью барплота. Барплоты students %&gt;% ggplot(aes(x=Walc)) + geom_bar(aes(fill = as.factor(Walc)), stat = &#39;count&#39;) + theme_minimal() Сейчас мы нарисовали точно такую же диаграмму, но с помощью атрибута geom_bar вместо geom_histogram функции ggplot. Гистограммного вида мы добились с помощью значения count атрибута stat. Этот атрибут означает, что вместо барплота, который строится по двум переменным x и y, мы будем строить график количества значений (гистограмму) для одной переменной x. Другой популярный вариант значения атрибута stat - значение identity, буквально означает “строим барплот как есть, по двум переменным”: students %&gt;% ggplot(aes(x=as.factor(age), y = Walc)) + geom_bar(aes(x=as.factor(age), y = as.factor(Walc), fill = as.factor(Walc)), stat = &#39;identity&#39;) + theme_minimal() students %&gt;% ggplot(aes(x=age, y = Walc)) + geom_bar(aes(x=age, y = Walc), stat = &#39;identity&#39;) + theme_minimal() Здесь я еще сделала преобразование as.factor для переменной age. students %&gt;% ggplot(aes(x = as.factor(age), y = as.factor(Walc))) + geom_bar(aes(fill = as.factor(Walc)), stat = &#39;identity&#39;) + theme_minimal() График плотности вероятности Если переменная количественная, и данные непрерывны – график плотности (вероятности). В нашем датасете на количественную непрерывную переменную больше всего похожи пропуски занятий students %&gt;% ggplot(aes(x=absences_por)) + geom_density() + theme_minimal() students %&gt;% ggplot(aes(x=absences_mat)) + geom_density() + theme_minimal() students %&gt;% ggplot(aes(x=G_por)) + geom_density() + theme_minimal() 10.3 Визуализации статистического вывода, которые тоже помогают понять данные Хорошо, посмотрели, как ведут себя данные в наших целевых переменных: что из себя представляют, каков характер распредедения. А что, если нам интересно посмотреть переменные не по одной, а в зависимости друг от друга? Если взять две переменные, по осям x и y? Такие графики мы обычно строим, когда нужно визуализироовать результаты какого-либо статистического тестирования: сравнения двух средних, поиска корреляции и т.д. Поэтому я назвала этот пункт “визуализациями статистического вывода”. Однако, сами статистические тесты сейчас я не провожу, но мне интересно взглянуть на данные, как они ведут себя уже не сами по себе, а в соответствии с выдвинутыми гипотезами? Диаграмма рассеяния students %&gt;% ggplot(aes(x = absences_mat, y = G_mat)) + geom_point(aes(colour = absences_mat)) + theme_minimal() Коррелограмма Допустим, мы хотим посмотреть корреляцию всех количественных переменных соо всеми (никогда так не делайте – вы обязательно найдетете какую-нибудь связь, возможно из-за статистической ошибки и несмотря на то, что не искали эту связь, и соблазн выдать ее за свою гипотезу будет слишком велик). students %&gt;% select(traveltime, studytime, famrel, freetime, Dalc, Walc, health, absences_mat, absences_por, G_mat, G_por) %&gt;% as.matrix() -&gt; students_numeric_matrix students_numeric_matrix %&gt;% cor() %&gt;% round(2) ## traveltime studytime famrel freetime Dalc Walc health ## traveltime 1.00 -0.10 -0.03 -0.06 0.16 0.11 0.02 ## studytime -0.10 1.00 0.00 -0.09 -0.17 -0.23 -0.04 ## famrel -0.03 0.00 1.00 0.09 -0.06 -0.13 0.14 ## freetime -0.06 -0.09 0.09 1.00 0.20 0.12 0.07 ## Dalc 0.16 -0.17 -0.06 0.20 1.00 0.65 0.06 ## Walc 0.11 -0.23 -0.13 0.12 0.65 1.00 0.07 ## health 0.02 -0.04 0.14 0.07 0.06 0.07 1.00 ## absences_mat 0.00 -0.08 -0.05 -0.05 0.15 0.21 0.01 ## absences_por 0.05 -0.13 -0.03 -0.01 0.11 0.15 0.00 ## G_mat -0.16 0.09 -0.05 -0.02 -0.07 -0.06 -0.06 ## G_por -0.18 0.24 -0.03 -0.10 -0.27 -0.18 -0.16 ## absences_mat absences_por G_mat G_por ## traveltime 0.00 0.05 -0.16 -0.18 ## studytime -0.08 -0.13 0.09 0.24 ## famrel -0.05 -0.03 -0.05 -0.03 ## freetime -0.05 -0.01 -0.02 -0.10 ## Dalc 0.15 0.11 -0.07 -0.27 ## Walc 0.21 0.15 -0.06 -0.18 ## health 0.01 0.00 -0.06 -0.16 ## absences_mat 1.00 0.56 -0.06 -0.13 ## absences_por 0.56 1.00 -0.12 -0.10 ## G_mat -0.06 -0.12 1.00 0.59 ## G_por -0.13 -0.10 0.59 1.00 Или более красивый и понятный вариант с помощью пакета Hmisc library(&quot;Hmisc&quot;) ## Loading required package: lattice ## Loading required package: survival ## Loading required package: Formula ## ## Attaching package: &#39;Hmisc&#39; ## The following objects are masked from &#39;package:dplyr&#39;: ## ## src, summarize ## The following objects are masked from &#39;package:base&#39;: ## ## format.pval, units students_numeric_matrix %&gt;% rcorr() ## traveltime studytime famrel freetime Dalc Walc health ## traveltime 1.00 -0.10 -0.03 -0.06 0.16 0.11 0.02 ## studytime -0.10 1.00 0.00 -0.09 -0.17 -0.23 -0.04 ## famrel -0.03 0.00 1.00 0.09 -0.06 -0.13 0.14 ## freetime -0.06 -0.09 0.09 1.00 0.20 0.12 0.07 ## Dalc 0.16 -0.17 -0.06 0.20 1.00 0.65 0.06 ## Walc 0.11 -0.23 -0.13 0.12 0.65 1.00 0.07 ## health 0.02 -0.04 0.14 0.07 0.06 0.07 1.00 ## absences_mat 0.00 -0.08 -0.05 -0.05 0.15 0.21 0.01 ## absences_por 0.05 -0.13 -0.03 -0.01 0.11 0.15 0.00 ## G_mat -0.16 0.09 -0.05 -0.02 -0.07 -0.06 -0.06 ## G_por -0.18 0.24 -0.03 -0.10 -0.27 -0.18 -0.16 ## absences_mat absences_por G_mat G_por ## traveltime 0.00 0.05 -0.16 -0.18 ## studytime -0.08 -0.13 0.09 0.24 ## famrel -0.05 -0.03 -0.05 -0.03 ## freetime -0.05 -0.01 -0.02 -0.10 ## Dalc 0.15 0.11 -0.07 -0.27 ## Walc 0.21 0.15 -0.06 -0.18 ## health 0.01 0.00 -0.06 -0.16 ## absences_mat 1.00 0.56 -0.06 -0.13 ## absences_por 0.56 1.00 -0.12 -0.10 ## G_mat -0.06 -0.12 1.00 0.59 ## G_por -0.13 -0.10 0.59 1.00 ## ## n= 320 ## ## ## P ## traveltime studytime famrel freetime Dalc Walc health ## traveltime 0.0651 0.6269 0.3188 0.0038 0.0597 0.7100 ## studytime 0.0651 0.9804 0.1011 0.0020 0.0000 0.4651 ## famrel 0.6269 0.9804 0.1044 0.3062 0.0238 0.0124 ## freetime 0.3188 0.1011 0.1044 0.0002 0.0333 0.2061 ## Dalc 0.0038 0.0020 0.3062 0.0002 0.0000 0.2849 ## Walc 0.0597 0.0000 0.0238 0.0333 0.0000 0.2088 ## health 0.7100 0.4651 0.0124 0.2061 0.2849 0.2088 ## absences_mat 0.9792 0.1414 0.3914 0.4091 0.0066 0.0002 0.8290 ## absences_por 0.3328 0.0157 0.5984 0.8386 0.0546 0.0070 0.9847 ## G_mat 0.0050 0.1221 0.3352 0.7490 0.2238 0.3051 0.2539 ## G_por 0.0014 0.0000 0.5365 0.0745 0.0000 0.0010 0.0040 ## absences_mat absences_por G_mat G_por ## traveltime 0.9792 0.3328 0.0050 0.0014 ## studytime 0.1414 0.0157 0.1221 0.0000 ## famrel 0.3914 0.5984 0.3352 0.5365 ## freetime 0.4091 0.8386 0.7490 0.0745 ## Dalc 0.0066 0.0546 0.2238 0.0000 ## Walc 0.0002 0.0070 0.3051 0.0010 ## health 0.8290 0.9847 0.2539 0.0040 ## absences_mat 0.0000 0.2991 0.0195 ## absences_por 0.0000 0.0369 0.0740 ## G_mat 0.2991 0.0369 0.0000 ## G_por 0.0195 0.0740 0.0000 Визуализируем матрицу корреляций в коррелограмму library(corrplot) ## corrplot 0.90 loaded corrplot(cor(students_numeric_matrix), method=&quot;circle&quot;) # corrplot(rcorr(students_numeric_matrix)$r, p.mat = rcorr(students_numeric_matrix)$P, sig.level = 0.05, insig = &quot;blank&quot;) heatmap(x = cor(students_numeric_matrix)) Боксплот и вайолин плот Если нам интересно посмотреть значения в группах, можно построить боксплот (тот самый ящик с усами) students %&gt;% ggplot(aes(x=Walc, y = age)) + geom_boxplot(aes(fill = as.factor(Walc))) + theme_minimal() Или даже лучше и информативнее – вайолин плот (повернутое на бок распределение плотности вероятности, зачастую вместе с ящиком с усами.) students %&gt;% ggplot(aes(x=Walc, y = age)) + geom_violin(aes(fill = as.factor(Walc))) + theme_minimal() Визуализация линейной регрессии students %&gt;% # slice(absences_mat&lt;40) %&gt;% ggplot(aes(x=absences_mat, y = G_mat)) + geom_point(aes(colour = absences_mat)) + geom_smooth(method=&quot;lm&quot;) + theme_minimal() ## `geom_smooth()` using formula &#39;y ~ x&#39; Визуализация логистической регрессии 10.4 Визуализации в R с помощью ggplot2 Грамматика графиков (The Crammar of Graphics) Большую часть этих графиков я визуализировала с помощью пакета ggplot2. Пару слов о том, как он работает. https://ggplot2.tidyverse.org/ По сути, это – универсальный конструктор графиков. Мы подгружаем данные, а дальше, послойно, собираем на них график как конструктор, накладывая каждый слой на предыдущий. В парадигме грамматики графиков любой график состоит из нескольких слоев: первый слой – данные, передаем их чаще всего первой строчкой с объявлением функции ggplot() geom (геометрический объект), обычно второй строчкой: geom_hist, geom_bar, geom_point, geom_line aes (эстетики) - аргумент geom или ggplot – оси x и y, цвета (для обводки и точек цвет задает через color, для заливки и объектов, имеющих плозадь – через fill). Пишут внутри aes() в скобках внутри геома или ggplot. Задавая аргументы-эстетики как бы натягиваем наши данные на координатную ось и геометрический объект, задаем правила преообразования данных в график. Это были обязательные слои построения графиков. Есть еще вспомогательные, которые доступны не для всех геомов: stat (статистические трансформации) - используется в основном для превращения барплота в гистограмму (stat=“count”) facets - позволяет отобразить график в фасетах themes - настраивает визуальные темы (вне зависимости от данных и геома: цвет фона графика, прозрачность подложки, толщина и цвет координатной сетки и т.д.) 10.5 Визуализации данных в системах для построения дашбордов https://www.tableau.com/ https://www.tableau.com/data-insights/dashboard-showcase https://www.datawrapper.de/ "],["статистики-вывода-главные-понятия-перед-расчетом-статистических-тестов.html", " 11 Статистики вывода: главные понятия перед расчетом статистических тестов 11.1 p-value и сравнение с α 11.2 Questionable and good research practices", " 11 Статистики вывода: главные понятия перед расчетом статистических тестов Проведен расчет выбранного статистического критерия с помощью выбранной функции Вид полученных результатов понятен для интерпретации, и результаты согласуются с представлением о том, как они должны выглядеть Результаты визуализированы, так, чтобы их было легче правильно воспринять Результаты проинтепретированы и сделан вывод относительно статистической и экспериментальной гипотез Итак, мы шли через весь чек-лист и готовились к самому главному – расчету выбранного статистического теста. Он даст нам несколько заветных цифр (значение самой статистики или коэффциента и p-value), по которым мы можем сделать вывод о связи между НП и ЗП, о различиях между группами или о вкладе какого-либо фактора в изменчивость наблюдаемых проявлений, в завимости от гипотезы. Что мы сделали (в идеале): Сформулировали теоретическую гипотезу (даже несколько) Выбрали исследовательский метод, в котором ее можно проверить Перевели теоретическую гипотезу на язык исследования и сформулировали эмпирическую гипотезу Выбрали статистический метод, которым будем проверять гипотезу Получили представление, как будут выглядеть собранные данные после проведения исследования Собрали данные Предобработали данные Посмотрели на ЗП и НП, участвующие в нашей гипотезе, посчитали для них описательные статисики, сделали описательные визуализации, сравнили их с нашими ожиданиями Теперь можем проводить расчет статистического метода! 11.1 p-value и сравнение с α p-value - вероятность получить такие (или более выраженные) различия, если нулевая гипотеза верна. 11.2 Questionable and good research practices John, L. K., Loewenstein, G., &amp; Prelec, D. (2012). Measuring the Prevalence of Questionable Research Practices With Incentives for Truth Telling. Psychological Science Использование сомнительных исследовательских практик (questionable research practices) значительно увеличивает вероятность сделать ложноположительный (false-positive) вывод в своем исследовани. Чему, как правило, равна вероятность сделать ложноположительный вывод? Это уровень значимости \\(\\alpha\\). Почему она может увеличиться, если мы поо умолчанию выбрали \\(\\alpha = 0.05\\)? Исследование, которое провели Simmons, Nelson, &amp; Simonsohn, 2011 называется “False-positive psychology: Undisclosed flexibility in data collection and analysis allows presenting anything as significant”. В этом исследовании они осознанно применяли сомнительные исследовательские практики, считали статистические тесты с их учетом (например, выкинув одну из переменных), проводили много-много симуляций таких тестов и затем сравнивали результаты с теми, которые они получили бы, если бы проводили анализ по всем правилам. Самые впечатляющие результаты: Манипуляции с выбором зависимых переменных (тестировали две, но выбрали только одну) увеличивают вероятность ложноположительного вывода с 5% до 9.5% (и согласно другому исследованию, около 78% психологов так делали (John et a., 2012)! Манипуляции с выбором экспериментальных условий (тестировали в трех, но выбрали только два из них увеличивают вероятность ложноположительного вывода с 5% до 12.6% (42% исследователей скорее всего через это проходили (John et a., 2012) Манипуляции с размером выборки (optional stopping, посмотрели на данные после 20 испытуемых, если не значимо — стали добирать и смотреть после 21, 22, 23 и тд испытуемых) увеличивает вероятность ложноположительного вывода с 5% до 50% (62%-72% исследователей исследователей использовали такую практику (John et a., 2012) Комбинация (1) + (2) + (3) увеличивает вероятность ложноположительного вывода с 5% до 60.7% Почему еще это плохо, не только для текущего исследования, но и для всей области? Во-первых, если в литературе появляется ложноположительный вывод — его сложно полностью опровергнуть, он остается в литературе практически во всех случаях. Исследователи продолжают целые линии экспериментов, основанные на ложноположительных результатах. Во-вторых, ложноположительные выводы стимулируют publication bias – публикацию только тех исследований, в которых подтвердились гипотезы. Выходит, что исследователи немного экстрасенсы и могут выбирать для исследований только те гипотезы, которые наверняка подтверядся. В-третьих, если ложноположительные резульататы в ветви исследований были обнаружены, это подрывают доверие ко всей линии. Good research practices Решать, когда останавливать сбор данных, до начала эксперимента. Правило, на котором это решение основано, должно быть указано в статье (расчет выборки на основании statistical power, анализ данных с использованием sequential analysis etc). До эксперимента решать, на каком основании и по каким правилам будут производиться выбросы данных, и указывать это в статье. Принимать решение о том, как данные будут обрабатываться, до начала эксперимента. В статье указывать все переменные и все экспериментальные условия, которые участвовали в эксперименте (даже если они оказались незначимы) Пререгистрировать исследование (хотя бы для себя). Постоянно прокачивать навыки в статистике и анализе данных. Это база, верхней границы навыка не существует. "],["статистики-вывода-расчет-разных-статистических-методов-для-проверки-гипотез.html", " 12 Статистики вывода: расчет разных статистических методов для проверки гипотез 12.1 Проверка гипотезы 3_a: корреляционный тест и линейная регрессия 12.2 Визуализации гипотезы 3_a: корреляционный тест и линейная регрессия 12.3 Проверка гипотезы 3_b: ANOVA 12.4 Визуализации гипотезы 3_b: ANOVA 12.5 Проверка гипотезы 1: тест Манна-Уитни 12.6 Визуализации гипотезы 1: тест Манна-Уитни 12.7 Проверка гипотезы 2: корреляционный тест 12.8 Визуализации гипотезы 2: корреляционный тест (методом Спирмена, для порядковых переменных) 12.9 Проверка гипотезы 2: порядковая логистическая регрессия 12.10 Пример для хи-квадрат 12.11 Визуализации для хи-квадрат 12.12 Пример для мультиномиальной логистической регрессии", " 12 Статистики вывода: расчет разных статистических методов для проверки гипотез Начнем проверять с третьей гипотезы, чтобы идти от простого статистического метода к более сложным. 12.1 Проверка гипотезы 3_a: корреляционный тест и линейная регрессия Первый вариант гипотезы 3 – о наличии линейной связи, проверяется корреляционным тестом и обычной линейной регрессией. Гипотеза 3_a Чем больше пропусков занятий, тем более низкий средний балл по предмету Проверяем корреляцию НП и ЗП: cor.test(~G_mat + absences_mat, data = students, method = &#39;pearson&#39;) ## ## Pearson&#39;s product-moment correlation ## ## data: G_mat and absences_mat ## t = -1.0401, df = 318, p-value = 0.2991 ## alternative hypothesis: true correlation is not equal to 0 ## 95 percent confidence interval: ## -0.1668011 0.0517444 ## sample estimates: ## cor ## -0.05822595 # cor.test(students$G_mat, students$absences_mat, method = &#39;pearson&#39;) эта запись эквивалентна предыдущей cor.test(~G_por + absences_por, data = students, method = &#39;pearson&#39;) ## ## Pearson&#39;s product-moment correlation ## ## data: G_por and absences_por ## t = -1.7923, df = 318, p-value = 0.07404 ## alternative hypothesis: true correlation is not equal to 0 ## 95 percent confidence interval: ## -0.207367985 0.009745291 ## sample estimates: ## cor ## -0.1000016 model_Gmat &lt;- lm(students$G_mat ~ students$absences_mat) summary(model_Gmat) ## ## Call: ## lm(formula = students$G_mat ~ students$absences_mat) ## ## Residuals: ## Min 1Q Median 3Q Max ## -9.3130 -2.1013 0.0045 2.4727 8.1262 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 11.31298 0.24196 46.76 &lt;2e-16 *** ## students$absences_mat -0.02645 0.02544 -1.04 0.299 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 3.559 on 318 degrees of freedom ## Multiple R-squared: 0.00339, Adjusted R-squared: 0.0002563 ## F-statistic: 1.082 on 1 and 318 DF, p-value: 0.2991 12.2 Визуализации гипотезы 3_a: корреляционный тест и линейная регрессия Сначала я включу пакет viridis, чтобы поменять дефолтные цвета на более красивые. Там, где я буду его использовать, я буду добавлять к графику scale_color_viridis() (для точек и контуров) или scale_fill_viridis() (для заливки объектов). Подробнее https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html library(viridis) students %&gt;% ggplot(aes(x=absences_mat, y = G_mat)) + geom_point(aes(colour = absences_mat)) + geom_smooth(method=&quot;lm&quot;) + scale_color_viridis() + theme_minimal() ## `geom_smooth()` using formula &#39;y ~ x&#39; Другой варивант этого же графика с помощью пакета ggstatsplot и функции из него ggscatterstats library(ggstatsplot) ## Warning: replacing previous import &#39;dplyr::collapse&#39; by &#39;glue::collapse&#39; when ## loading &#39;statsExpressions&#39; ## You can cite this package as: ## Patil, I. (2021). Visualizations with statistical details: The &#39;ggstatsplot&#39; approach. ## Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167 ggscatterstats(data = students, x = absences_mat, y = G_mat, bf.message = FALSE) ## Registered S3 method overwritten by &#39;ggside&#39;: ## method from ## +.gg ggplot2 ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`. 12.3 Проверка гипотезы 3_b: ANOVA Гипотеза 3_b Студенты, у кого было от 0 до 5 пропусков, от 6 до 15 и больше 15 будут иметь разный средний балл по предмету Эта гипотеза предполагает сравнение трех групп, тестируем ANOVA. Сначала создадим новые переменные, чтобы перекодировать пропуски в группы: students %&gt;% mutate(ansences_mat_groups = ifelse(absences_mat &lt;=5, &quot;less&quot;, ifelse(absences_mat &lt;=15, &quot;middle&quot;, &quot;more&quot;))) %&gt;% mutate(ansences_por_groups = ifelse(absences_por &lt;=5, &quot;less&quot;, ifelse(absences_por &lt;=15, &quot;middle&quot;, &quot;more&quot;))) -&gt; students kable(students[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) student school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat paid_por absences_por G1_por G2_por G3_por G_mat G_por ansences_mat_groups ansences_por_groups id1 GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 no 4 0 11 11 5.666667 7.333333 middle less id2 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 no 2 9 11 11 5.333333 10.333333 less less id4 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 no 0 14 14 14 14.666667 14.000000 less less id5 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 no 0 11 13 13 8.666667 12.333333 less less id6 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 no 6 12 12 13 15.000000 12.333333 middle middle id7 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 no 0 13 12 13 11.666667 12.666667 less less id8 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 no 2 10 13 13 5.666667 12.000000 middle less id9 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 no 0 15 16 17 17.666667 16.000000 less less id10 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 no 0 12 12 13 14.666667 12.333333 less less id11 GP F 15 U GT3 T 4 4 teacher health reputation mother 1 2 0 no yes yes no yes yes yes no 3 3 3 1 2 2 0 10 8 9 no 2 14 14 14 9.000000 14.000000 less less Применим тест Классическое выполнение ANOVA в R: model_abs_mat &lt;- aov(G_mat ~ ansences_mat_groups, data = students) summary(model_abs_mat) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ansences_mat_groups 2 22 10.87 0.857 0.425 ## Residuals 317 4021 12.68 model_abs_por &lt;- aov(G_por ~ ansences_por_groups, data = students) summary(model_abs_por) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ansences_por_groups 2 14.5 7.236 1.154 0.317 ## Residuals 317 1987.6 6.270 ANOVA в R c помощью более тонко и понятно настраеваемой функции ezANOVA из пакета ez: ## Registered S3 methods overwritten by &#39;lme4&#39;: ## method from ## cooks.distance.influence.merMod car ## influence.merMod car ## dfbeta.influence.merMod car ## dfbetas.influence.merMod car ## Warning: Converting &quot;student&quot; to factor for ANOVA. ## Warning: Converting &quot;ansences_mat_groups&quot; to factor for ANOVA. ## Warning: Data is unbalanced (unequal N per group). Make sure you specified a ## well-considered value for the type argument to ezANOVA(). ## Coefficient covariances computed by hccm() ## $ANOVA ## Effect DFn DFd F p p&lt;.05 ges ## 1 ansences_mat_groups 2 317 0.8568567 0.4254751 0.005376968 ## ## $`Levene&#39;s Test for Homogeneity of Variance` ## DFn DFd SSn SSd F p p&lt;.05 ## 1 2 317 11.28622 1450.235 1.233501 0.2926653 12.4 Визуализации гипотезы 3_b: ANOVA Уже знакомые нам боксплоты: “ящики с усами”, горизонтальная линия посредеине обозначает медиану в данных, границы коробочек – начало первого и конец третьего квартиля данных (если построить описательный график плотности вероятности или гистограмму для данной зависимой переменной) students %&gt;% ggplot(aes(x=ansences_mat_groups, y = G_mat)) + geom_boxplot(aes(fill = ansences_mat_groups)) + scale_fill_viridis(discrete=TRUE) + theme_minimal() Другой вариант того же графика – вайолин плот. students %&gt;% ggplot(aes(x=ansences_mat_groups, y = G_mat)) + geom_violin(aes(fill = ansences_mat_groups)) + geom_boxplot(aes(fill = ansences_mat_groups), width=.1) + scale_fill_viridis(discrete=TRUE) + theme_minimal() 12.5 Проверка гипотезы 1: тест Манна-Уитни Наши гипотезы трансформировались в: Гипотеза 1_a: студенты возраста 15, 16, 17 лет будут выбирать меньшие значения переменной Walc, чем студенты 18 лет и старше Гипотеза 1_b: студенты возраста 15 лет будут выбирать меньшие значения переменной Walc, чем студенты 16 лет и старше Чтобы их проверить, перекодируем переменную age в новые переменные: students %&gt;% mutate(adult = ifelse(age &gt;= 18, &quot;yes&quot;, &quot;no&quot;)) %&gt;% mutate(`15th` = ifelse(age == 15, &quot;yes&quot;, &quot;no&quot;)) -&gt; students #создали переменную, которая делит студентов на совершеннолетних и нет kable(students[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) student school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat paid_por absences_por G1_por G2_por G3_por G_mat G_por ansences_mat_groups ansences_por_groups adult 15th id1 GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 no 4 0 11 11 5.666667 7.333333 middle less yes no id2 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 no 2 9 11 11 5.333333 10.333333 less less no no id4 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 no 0 14 14 14 14.666667 14.000000 less less no yes id5 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 no 0 11 13 13 8.666667 12.333333 less less no no id6 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 no 6 12 12 13 15.000000 12.333333 middle middle no no id7 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 no 0 13 12 13 11.666667 12.666667 less less no no id8 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 no 2 10 13 13 5.666667 12.000000 middle less no no id9 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 no 0 15 16 17 17.666667 16.000000 less less no yes id10 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 no 0 12 12 13 14.666667 12.333333 less less no yes id11 GP F 15 U GT3 T 4 4 teacher health reputation mother 1 2 0 no yes yes no yes yes yes no 3 3 3 1 2 2 0 10 8 9 no 2 14 14 14 9.000000 14.000000 less less no yes Итак, пойдем по алгоритму. В тесте Гипотезы 1_a ЗП – порядковая, ЗП может принимать 5 значений – значит, я рассматриваю ее как количественную. Далее, одна НП, и наша гипотеза – о сравнении двух групп между собой. Эти группы независимы (тестируются оценки разных студентов, никак не связанных друг с другом). Значит, будем использовать тест Манна-Уитни (Mann-Whitney test) wilcox.test(students$Walc ~ students$adult, paired = FALSE, alternative = &quot;greater&quot;) ## ## Wilcoxon rank sum test with continuity correction ## ## data: students$Walc by students$adult ## W = 8539.5, p-value = 0.676 ## alternative hypothesis: true location shift is greater than 0 В тесте Гипотезы 1_b ЗП – порядковая, ЗП может принимать 5 значений – значит, я рассматриваю ее как количественную. Далее, одна НП, и наша гипотеза – о сравнении двух групп между собой. Эти группы независимы (тестируются оценки разных студентов, никак не связанных друг с другом). Значит, будем использовать тест Манна-Уитни (Mann-Whitney test) wilcox.test(students$Walc ~ students$`15th`, paired = FALSE, alternative = &quot;greater&quot;) ## ## Wilcoxon rank sum test with continuity correction ## ## data: students$Walc by students$`15th` ## W = 11326, p-value = 7.892e-05 ## alternative hypothesis: true location shift is greater than 0 Чем отличаются результаты тестов? 12.6 Визуализации гипотезы 1: тест Манна-Уитни students %&gt;% ggplot(aes(x=adult, y = Walc)) + geom_boxplot(aes(fill = adult)) + scale_fill_viridis(discrete=TRUE) + theme_minimal() students %&gt;% ggplot(aes(x=`15th`, y = Walc)) + geom_boxplot(aes(fill = `15th`)) + scale_fill_viridis(discrete=TRUE) + theme_minimal() 12.7 Проверка гипотезы 2: корреляционный тест Проведем тест для следующей гипотезы. Гипотеза 2 Чем ниже студенты оценивают качество семейных отношений famrel, тем выше они отмечают частоту употребления алкоголя Walc Пойдем также по алгоритму. ЗП – порядковая, ЗП может принимать 5 значений – значит, я рассматриваю ее как количественную. Одна независимая переменная, так же порядковая, то есть точно непараметрическая. Наша гипотеза не о сравнении групп, об ассоциативной (корреляционной) связи. Значит, следует использовать либо ранговую корреляцию Спирмена, либо порядковую логистическую регрессию (если я хочу, чтобы связь имела предсказательную силу). Начнем с простого – корреляции Спирмена cor.test(students$famrel, students$Walc, method = &#39;spearman&#39;) ## Warning in cor.test.default(students$famrel, students$Walc, method = ## &quot;spearman&quot;): Cannot compute exact p-value with ties ## ## Spearman&#39;s rank correlation rho ## ## data: students$famrel and students$Walc ## S = 6173557, p-value = 0.0196 ## alternative hypothesis: true rho is not equal to 0 ## sample estimates: ## rho ## -0.130423 12.8 Визуализации гипотезы 2: корреляционный тест (методом Спирмена, для порядковых переменных) Первый вариант – мозаичный плот: размер плитки отражает частоту совпадения таких значений двух переменных. Указываем НП как x=product(НП), и ЗП как fill = ЗП. library(ggmosaic) students %&gt;% ggplot(aes()) + geom_mosaic(aes(x = product(famrel), fill = Walc)) + scale_fill_viridis(discrete=TRUE) + theme_minimal() Другой вариант – хитмеп, как в коррелограмме, где размеры фиксированные, а за частоту совпадений отвечает цвет. students %&gt;% ggplot(aes(x = as.factor(famrel), y = as.factor(Walc))) + geom_bin2d() + scale_fill_viridis() + theme_minimal() + theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank()) 12.9 Проверка гипотезы 2: порядковая логистическая регрессия Попробуем порядковую логистическую регрессию ## ## Attaching package: &#39;MASS&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## select ## Call: ## polr(formula = as.factor(Walc) ~ as.factor(famrel), data = students, ## Hess = TRUE) ## ## Coefficients: ## Value Std. Error t value ## as.factor(famrel)2 -0.6749 0.9380 -0.7195 ## as.factor(famrel)3 -0.3941 0.8104 -0.4863 ## as.factor(famrel)4 -0.7474 0.7870 -0.9497 ## as.factor(famrel)5 -1.0775 0.7971 -1.3518 ## ## Intercepts: ## Value Std. Error t value ## 1|2 -1.1787 0.7757 -1.5196 ## 2|3 -0.2620 0.7751 -0.3381 ## 3|4 0.7370 0.7814 0.9432 ## 4|5 1.9655 0.7975 2.4645 ## ## Residual Deviance: 920.8895 ## AIC: 936.8895 И добавим p-value ctable &lt;- coef(summary(famrel_ordered_model)) p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2 ctable &lt;- cbind(ctable, &quot;p value&quot; = p) ctable ## Value Std. Error t value p value ## as.factor(famrel)2 -0.6749367 0.9380228 -0.7195313 0.47181365 ## as.factor(famrel)3 -0.3940742 0.8103672 -0.4862908 0.62676098 ## as.factor(famrel)4 -0.7474178 0.7870231 -0.9496770 0.34227639 ## as.factor(famrel)5 -1.0774883 0.7970952 -1.3517685 0.17644937 ## 1|2 -1.1787296 0.7756805 -1.5196070 0.12860978 ## 2|3 -0.2620218 0.7750710 -0.3380616 0.73531675 ## 3|4 0.7369875 0.7813711 0.9431979 0.34557970 ## 4|5 1.9654590 0.7975037 2.4645141 0.01371992 12.10 Пример для хи-квадрат Хи-квадратом мы обычно проверяем коррялцию двух категориальных переменных между собой: порядковых, если у нас не шкала Лайерта или мало возможных значений, и метод корреляции Спирмена не подходит, или номинальных, где корреляцию Спирмена провести уже невозможно. Например, давайте проверим гипотезу о том, что наличие или отсутствие интернета в квартире связано с наличием или отсутствием романтических отношений. Предположим, что португальские школьники, у кого дома есть интернет, реже вступают в романтические отношения, по сравнению с теми, у кого интернета нет. Для этого будем использовать метод хи-квадрат. НП – наличие или отсутствие интернета (переменная internet), ЗП – наличие или отсутствие романтических отношений (romantic). Проведем тест: chisq.test(students$internet, students$romantic, correct=FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: students$internet and students$romantic ## X-squared = 3.9258, df = 1, p-value = 0.04755 Сравниваем полученное p-value с выбранным уровнем \\(\\alpha = 0.05\\). p-value &lt; α, значит, вероятность получить такую связь между переменными при условии, если на самом деле ее нет, меньше нашего допустимого уровня ложноположительных результатов, мы отвергаем нулевую гипотезу и делаем вывод о наличии корреляционной связи. 12.11 Визуализации для хи-квадрат Хи-квадрат чаще всего визуализируют уже знакомым по корреляции Спирмена мозаичным графиком. Указываем НП как x=product(НП), и ЗП как fill = ЗП. library(ggmosaic) students %&gt;% ggplot(aes()) + geom_mosaic(aes(x = product(internet), fill = romantic)) + scale_fill_viridis(discrete=TRUE) + theme_minimal() 12.12 Пример для мультиномиальной логистической регрессии Предположим, у нас есть предположение, что категорию пропусков занятий (“мало”, “средне”, “много”) можно предсказать по наличию дома интернета, работе матери и наличию или отсутствию романтических отношений (! это НЕ СОДЕРЖАТЕЛЬНАЯ ГИПОТЕЗА. Если юы мы задумали такое исследование, нам было бы сложно объяснить, почему мы вообще решили такое исследоваить. Этот тест здесь просто для примера мультином лог регрессии). Переменная ansences_mat_groups категориальная, принимает 3 возможных значения: “less”, “middle”, “more”, и мы будем строить для нее мультиноомиальную логистическую регрессию. Строить модель будем с помощью пакета nnet фунции multinom. Сначала нам нужно выбрать референсной значение – противоположное тому, которое мы хотим предсказать. Здесь у нас гипотеза связана с тем, что наличие интернета, романтических отношений и образования матери, связанное с отсутствие дома, может быть связано с большим количеством пропусков. Поэтому за референсное значение берем то, где меньше всего пропусков. library(nnet) students$ansences_mat_groups2 &lt;- relevel(as.factor(students$ansences_mat_groups), ref = 3) levels(students$ansences_mat_groups2) ## [1] &quot;more&quot; &quot;less&quot; &quot;middle&quot; Строим саму модель: model_ansences_mat_groups &lt;- multinom(ansences_mat_groups ~ internet + Mjob + romantic, data = students) ## # weights: 24 (14 variable) ## initial value 351.555932 ## iter 10 value 256.138935 ## iter 20 value 255.444149 ## iter 20 value 255.444149 ## iter 20 value 255.444149 ## final value 255.444149 ## converged summary(model_ansences_mat_groups) ## Call: ## multinom(formula = ansences_mat_groups ~ internet + Mjob + romantic, ## data = students) ## ## Coefficients: ## (Intercept) internetyes Mjobhealth Mjobother Mjobservices Mjobteacher ## middle -1.130146 -0.2101027 0.07617281 0.08843108 0.4446334 0.6689585 ## more -3.832296 1.1576313 -0.66428760 0.11017326 0.9395912 0.1361420 ## romanticyes ## middle 0.6781589 ## more 0.7151319 ## ## Std. Errors: ## (Intercept) internetyes Mjobhealth Mjobother Mjobservices Mjobteacher ## middle 0.4185274 0.3764586 0.568958 0.4241679 0.4616164 0.4780972 ## more 1.1613018 1.0681404 1.274832 0.8440447 0.8403030 0.9690785 ## romanticyes ## middle 0.2723936 ## more 0.4720498 ## ## Residual Deviance: 510.8883 ## AIC: 538.8883 Обратите внимание, что в аутпуте модели нет p-value – чтобы их получить, нужно выполнить дополнительнве действия, пока пропустим их. Визуализируем результаты: # students %&gt;% # ggplot(aes(x = Mjob, y = probability)) + # geom_line() + # facet_grid(ansences_mat_groups ~., scales = &quot;free&quot;) Более подробно можно изучить этот анадиз по ссылке https://bookdown.org/chua/ber642_advanced_regression/multinomial-logistic-regression.html, для визуализации результатов лучше всего подойдут кривые вероятностей, как здесь https://stats.oarc.ucla.edu/r/dae/multinomial-logistic-regression/ "]]
