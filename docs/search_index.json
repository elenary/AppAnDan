[["index.html", "Прикладной анализ данных 1 Чек-лист работы с данными", " Прикладной анализ данных Елена Рыбина 2022-06-02 1 Чек-лист работы с данными Рассмотрим, как должен выглядеть чек-лист работы с данными для проверки себя, если бы эти экспериментальные данные мы собирали бы сами? —–Теоретический этап, планирование работы с данными—– Сформулированы теоретические гипотезы. Сформулированы эмпирические гипотезы. Есть понимание, как будут выглядеть собранные данные. Исходя из гипотезы и того, как будут собраны и какие это данные, выбран статистический метод проверки экспериментальной гипотезы (и хорошо, если есть понимание о статистической гипотезе – это уже про H0 и H1) Выбрана среда для анализа данных и конкретная функция под выбранный статистический критерий (или несколько функций) (если нужно - установлен пакет для выбранных функций). —–Данные собраны—– Собранные данные предобработаны и приведены в вид, к которому можно применить выбранный статистический метод. Выбранные для анализа предобработанные переменные исследованы описательными статистиками и визуализированы для лучшего понимания данных. Проведен расчет выбранного статистического метода с помощью выбранной функции. Результаты визуализированы, так, чтобы их было легче правильно интерпретировать. Результаты проинтепретированы и сделан вывод относительно изначальной эмпирической гипотезы. Теперь пройдемся подробнее по некоторым из этих пунктов. В качестве примера возьмем датасет с kaggle https://www.kaggle.com/datasets/uciml/student-alcohol-consumption. Это – данные из двух португальских школ (скорее колледжей) с подробной социо-демографической информации о студентах, включая ту, как они учатся по математике и португальскому языку и как часто пьют алкоголь. Этот датасет я взяла, так как он содержит переменные разного типа данных в разных шкалах (и шкала отношений, например, возраст, и порядковая шкала, например, рейтинггования образования мамы или папы или поддержка в семье). studens_mat &lt;- read_csv(&quot;student-mat.csv&quot;) ## ## ── Column specification ──────────────────────────────────────────────────────── ## cols( ## .default = col_character(), ## age = col_double(), ## Medu = col_double(), ## Fedu = col_double(), ## traveltime = col_double(), ## studytime = col_double(), ## failures = col_double(), ## famrel = col_double(), ## freetime = col_double(), ## goout = col_double(), ## Dalc = col_double(), ## Walc = col_double(), ## health = col_double(), ## absences = col_double(), ## G1 = col_double(), ## G2 = col_double(), ## G3 = col_double() ## ) ## ℹ Use `spec()` for the full column specifications. studens_mat %&gt;% rename_with(., ~ paste0(., &quot;_mat&quot;), .cols = c(absences, paid, G1, G2, G3)) -&gt; studens_mat #переименовываю колонки для упрощения понимания, какие относятся к математикие kable(studens_mat[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) #визуализирую табличку для этой книжки school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 GP F 15 U LE3 T 1 1 at_home other other mother 1 2 3 yes no yes no yes yes yes no 4 3 2 2 3 3 10 7 8 10 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 studens_por &lt;- read_csv(&quot;student-por.csv&quot;) ## ## ── Column specification ──────────────────────────────────────────────────────── ## cols( ## .default = col_character(), ## age = col_double(), ## Medu = col_double(), ## Fedu = col_double(), ## traveltime = col_double(), ## studytime = col_double(), ## failures = col_double(), ## famrel = col_double(), ## freetime = col_double(), ## goout = col_double(), ## Dalc = col_double(), ## Walc = col_double(), ## health = col_double(), ## absences = col_double(), ## G1 = col_double(), ## G2 = col_double(), ## G3 = col_double() ## ) ## ℹ Use `spec()` for the full column specifications. studens_por %&gt;% rename_with(., ~ paste0(., &quot;_por&quot;), .cols = c(absences, paid, G1, G2, G3)) -&gt; studens_por kable(studens_por[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) #визуализирую табличку для этой книжки school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_por activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_por G1_por G2_por G3_por GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 4 0 11 11 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 2 9 11 11 GP F 15 U LE3 T 1 1 at_home other other mother 1 2 0 yes no no no yes yes yes no 4 3 2 2 3 3 6 12 13 12 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes no yes yes yes yes yes 3 2 2 1 1 5 0 14 14 14 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes no no yes yes no no 4 3 2 1 2 5 0 11 13 13 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes no yes yes yes yes no 5 4 2 1 2 5 6 12 12 13 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 13 12 13 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 2 10 13 13 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes no no yes yes yes no 4 2 2 1 1 1 0 15 16 17 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes no yes yes yes yes no 5 5 1 1 1 5 0 12 12 13 "],["теоретические-гипотезы.html", " 2 Теоретические гипотезы", " 2 Теоретические гипотезы Сформулированы теоретические гипотезы Возьмем первую придуманную гипотезу: в датасете есть студенты возрастов от 15 до 22 двух лет. Возможно, те, кто младше, будут бояться признаться в употрблении алкоголя и отвечать так, будто не употрябляют его. Они вляются несовершеннолетними и могут бояться, что родители узнают. Эта гипотеза хороша тем, что она имеет понятное теоретическое обоснование, она проверяема на наших данных, и данные подходят для того, чтобы ее проверить Вторая гипотеза: студенты с менее поддерживающими отношениями в семье чаще употребляют алкоголь. Эта гипотеза так же понятна, имеет теоретическое обосноование, проверяема в исследовании, и наши данные подходят для ее проверки. У меня была еще одна, третья гипотеза: что студенты, пропускающие много занятий, буду иметь более низкий средний балл по математике и португальскому. "],["эмпирические-гипотезы.html", " 3 Эмпирические гипотезы 3.1 Зависимые (ЗП) и независимые (НП) переменные в гипотезе 3.2 Типы шкал 3.3 Связь между ЗП и НП: какая она бывает? 3.4 Гипотезы о связи и гипотезы о разнице между группами 3.5 Уровни НП в качественных переменных", " 3 Эмпирические гипотезы Сформулированы эмпирические гипотезы Эмпирические гипотезы – те, которые мы можем проверить опытным путем. Чтобы правильно их сформулировать, нам надо также определиться с типом эмпирического исследования, которое возможно для проверки наших теоретических гипотез. В психологических исследованиях это чаще всего эксперимент, квази-эксперимент, корреляционное исследование(и лонгитюдное исследование как его подвид). Иногды бывает case study, исследование одного конкретного случая, чаще в когнитивной психологии и нейронауках. В нашем случае все гипотезы рождены из одного заполнения опросника – значит, все, о чем мы можем говорить, это корреляции. Чуть позже поодробнее рассмотрим, почему, а пока попробуем сформулировать гипотезы. Гипотеза 1 в контексте нашего исследования и существующих переменных звучит так: студенты возраста 15-17 лет (переменная age) при ответе на вопрос об употреблении алкоголя в выходные дни (переменная Walc) будут выбирать варианты ответов, ассоциированные с как можно более редким употреблением - 1 или 2 Гипотеза 2 Студенты, кто оценивает отношения с родителями как менее поддерживающие (переменная famrel, менее поддерживающие в значениях 1-2), чаще употребляют алкоголь (переменная Walc, возьмем тоже выходные дни, значения 4-5) Гипотеза 3 Студенты, у кого было много пропусков (переменная absences_mat или absences_por, высокие значения), будут иметь более низкий средний балл (среднее из переменных G1_mat, G2_mat, G3_mat или G1_por, G2_por, G3_por -- низкие значения) Давайте сначала подумаем, что это за гипотезы, какие зависимые и независимые переменные, наличие или отсутствие какой связи между зависимой и независимыми переменными нам хочется проверить? 3.1 Зависимые (ЗП) и независимые (НП) переменные в гипотезе Рассмотрим гипотезу 1. Что в ней является зависимой и независимой переменной? Сейчас гипотеза сформулирована так, что НП – это возраст (age), а ЗП – это количество употребления алкоголя Walc. Согласны ли вы с таким разделением? Почему? Иногда бывает сложно определить, что будет являться зависимой и независимыми переменными. Независимые переменные – это все, чем мы манипулируем по ходу проведения исследования, с целью получить разный результат. Зависимая – целевая переменная, то, что мы измереяем, изменения в чем мы ожидаем получить после манипуляции независимыми переменными. При описании исследования всегда важно записывать ЗП и НП, наряду с экспериментальной (эмпирической) гипотезой – сердце нашего исследования, самое основное из языка, на котором описывается исследование. Следующий вопрос – к какой шкале относятся ЗП и НП? Это важно понимать, чтобы потом выбрать, как анализировать данные. 3.2 Типы шкал Шкала Описание Возможные операции Примеры Наименований (номинальная) Качественная (категориальная), нельзя установить “больше” или “меньше” =, \\(\\neq\\) shcool, sex, address, famsize, Mjob, Fjob, schoolsup Порядка (ранговая) Качественная (категориальная), можно установить “больше” или “меньше”, но нельзя посчитать количественно, на сколько больше или меньше =, \\(\\neq\\), &gt;, &lt; Medu, Fedu, traveltime, studytime, famrel, freetime, goout, Dalc, Walc, health Разности (интервальная) Количественная, но нет абсоолютного нуля, можно посчитать на сколько больше или меньше, но нельзя посчитать, во сколько раз =, \\(\\neq\\), &gt;, &lt;, +, - G (отнесу сюда, так как с оценками все сложно) Отношений (абсолютная) Количественная, есть абсолютный ноль, можно посчитать и на сколько больше или меньше, и во сколько раз =, \\(\\neq\\), &gt;, &lt;, +, -, ×, ÷ age, failures, absences Опишем переменные для гипотезы 1. Возраст (age) – это количественная переменная, в целом про возраст мы можем сказать, что он непрерывен (здесь возраст округлен до целых, поэтому на которотком промежутке возрастов это может сыграть роль) Чуть позже посмотрим на переменную возраста в описательных статистиках, чтобы убедиться, что можем работать с ней как с непрерывной переменной. У возраста есть абсолютный ноль (нельзя быть возраста “-10 лет”), можем сказать, что человек возраста 30 лет в два раза старше человека возраста 15 лет, поэтому возраст относится к шкале отношений. Walc – явно относится к порядковой шкале: можем сказать, что студенты, ответившие “4” на вопрос про употребление алкоголя, употребляют его больше, чем те, кто выбрал “2”, но не можем сказать, что в количестве выпитого алкоголя эта разница выражается как в два раза больше. К каким шкалам относятся переменные для гипотезы 2 и гипотезы 3? 3.3 Связь между ЗП и НП: какая она бывает? Сейчас гипотезы 1 и 2 сформулированы так: студенты возраста 15-17 лет (переменная age) при ответе на вопрос об употреблении алкоголя в выходные дни (переменная Walc) будут выбирать варианты ответов, ассоциированные с как можно более редким употреблением - 1 или 2 Студенты, кто оценивает отношения с родителями как менее поддерживающие (переменная famrel, менее поддерживающие в значениях 1-2), чаще употребляют алкоголь (переменная Walc, возьмем тоже выходные дни, значения 4-5) Мы выяснили, что в первой гипотезе НП – это возраст (age), а ЗП – это количество употребления алкоголя Walc. Во второй гипотезе НП – оценка отношений с родителями (famrel), и та же ЗП (Walc). То есть, разворачивая такую формулировку, мы считаем, что возраст и качество отношений в семье влияет на ответы. Если смотреть на данные, выводы о какой связи мы можем установить? Два основных вида связи между переменными: Ассоциативная или корреляционная Причинно-следственная Три необходимых условия для установления причинно-следственной связи: Изменение НП произошло раньше, чем мы пронаблюдали изменение в ЗП Изменения НП имеют ассоциативную связь с изменениямм в ЗП Нет никаких альтернативных объяснений изменений в ЗП, помимо изменений НП Сейчас у нас есть только опросные данные, в которых студенты отвечали на вопросы одновременно. Получается, что в таком дизайне исследования мы не проходим необходимые условия для установления причинно-следственной связи, следовательно, сделать вывод о причинно-следственной связи не можем. Причинно-следственную связь мы можем установить только в ходе эксперимента или квази-эксперимента (отличается от эксперимента тем, что испытуемые не распределяются в группы рандомно, а используются уже существующие, например, разные страны). Во всех остальных видах исследований, особенно когда используются самоотчеты и опросники, мы можем говорить только об ассоциативной или корреляционной связи. Важно отметить, что вполне возмодно, на самом деле эта связь будет причинно-следственной. Вполне вероятно, что плохие отношения в семье приводят у алкоголизму у детей. Но у нас есть только данные опросника, и из тех данных того исследования, которые у нас есть, мы можем судить только о корреляции. Несмотря на то, что мы говорим о корреляции, тут тоже есть варианты. Сравните гипотезы: чем меньше возраст студентов (age), чем ниже будут ответы в переменной Walc и студенты возраста 15, 16, 17 лет будут выбирать меньшие варианты ответа в переменной Walc или студенты возраста 15 лет будут выбирать меньшие варианты ответа в переменной Walc. Чем они отличаются? 3.4 Гипотезы о связи и гипотезы о разнице между группами Первый вариант этой гипотезы – это гипотеза о наличии ассоциативной (корреляционной) связи между ЗП и НП: чем больше / меньше значение НП, тем больше / меньше значение ЗП. Второй и третий варианты подразумевают сравнения групп – чаще всего, средних значений в этих группах. Здесь мы выделяем группы: “студенты младше 18 лет” и “студенты 18 лет и старше”, или “студенты возраста 15 лет” и “студенты возраста НЕ 15 лет”. От этого, хотим мы проверить наличие связи между переменными или сравнить средние значения в нескольких группах, будет так же зависеть выбор статистичекого метода для проверки гипотезы. Пока запомним, что при формулировки гипотезы нам важно, будет ли это гипотеза о связи между переменными или сравнение среднего значения ЗП в нескольких группах. 3.5 Уровни НП в качественных переменных Об уровнях в НП говорят в категориальных (порядковых или номинативных), качественных переменных. Например, условия “часто” и “редко”, условия “обеспеченная семья” или “не обеспеченная”. В примерах выше для гипотезы чем меньше возраст студентов (age), чем ниже будут ответы в переменной Walc мы не можем выделить уровни НП, ЗП непрерывная, тем боле, это гипотеза о наличи связи между переменными, связи каждого значения НП с каждым значением ЗП, уровни тут невозможны. Однако в гипотезе студенты возраста 15, 16, 17 лет будут выбирать меньшие варианты ответа в переменной Walc мы собираемся сравнить две группы, и здесь можно говорить об уровнях “студенты младше 18 лет” и “студенты 18 лет и старше”. Чтобы это сделать, нам нужно перекодировать переменную age в новую, категориальную переменную, со значениями “младше 18 лет” и “18 и старше”. "],["представление-о-собранных-данных.html", " 4 Представление о собранных данных", " 4 Представление о собранных данных Есть понимание, как будут выглядеть собранные данные Итак, мы подробно разобрались, какие у нас гипотезы. Теперь можно подумать о том, как будут выглядеть собранные данные для проверки этих гипотез. Здесь мы работаем с уже готовым датасетом, поэтому понимание о собранных данных у нас есть. Но в реальной жизни прежде, чем начинать сбор данных, нужно хорошо представлять себе, как будут записываться данные: это логи в текстовом файле, и нам нужно будет вручную выковыривать цифры и собирать табличку? Если да, можно ли это автоматизировать? Или это эксель-табличка, в которую данные будут писаться в уже пригодном для работы виде? Если нет, можем ли мы сделать что, чтобы данные писались в такую удобную табличку еще на этапе кодирования эксперимента? Этот самый момент, когда мы уже определили гипотезы и отправляемся разрабатывать дизайн эксперимента и кодировать его в PsychoPy или другой среде. До кодирования нужно будет понимать, как мы будем собирать данные, как они будут выглядеть, сможем ли мы сделать с ними все, что хотим, применить нужный статистический метод? "],["выбор-статистического-метода-уровня-значимость-и-статистической-мощности-статистики-вывода.html", " 5 Выбор статистического метода, уровня значимость и статистической мощности (статистики вывода) 5.1 Проверка статистических гипотез (NHST, Null Hypothesis Statistical Testing) 5.2 Выбор статистических методов для разных гипотез", " 5 Выбор статистического метода, уровня значимость и статистической мощности (статистики вывода) Исходя из гипотезы и того, как будут собраны и какие это данные, выбран статистический метод проверки экспериментальной гипотезы До кодирования эксперимента или в начале кодирования мы так же определеяем, каким статистическим критерием будем проверять наши гипотезу. Сейчас, в случае с уже готовым дататестом, все не совсем так, и мы на уже датасете пытаемся восстановить изначальные гипотезы, для проверки которых этот датасет собирался. Вообще пытаться прикрутить гипотезу к уже собранным данным – это плохая научная практика, которая приводит к большому числу ложноположительных результатов. Об этом мы тоже будем говорить на одном из семинаров. Раздел статистики, который относится к установлению статистического вывода относительно связи между переменными в популяции (генеральной совокупности), называется ровно так: статистический вывод, или inferential statistics. Наша цель в статистическом выводе – получить ответы на вопросы: связаны ли незавасимые и зависимая переменные между собой, и если да, то как? Отличаются несколько групп между собой по значением зависимой переменной? Для этого нам нужно выбрать статистический метод, которым мы будем проверять гипотезу, и условия, в которых он прооводится: уровень значимости и статистическая мощность. 5.1 Проверка статистических гипотез (NHST, Null Hypothesis Statistical Testing) Давайте немного разберемся, что проиходит, когда мы применяем статистический метод для проверки гипотез. Что вообще мы имеем в виду под проверкой гипотез? У нас есть данные исследований, которые мы собрали на какой-то выборке, часто не очень большой. Но когда мы делаем выводы относительно связи между НП и ЗП, мы говорим не о нашей небольшой группе людей, которых мы исследовали – а о всей популяции людей, она называется генеральной совокупностью. Почему так можно? Собственно, за это и отвечает математика и теория вероятностей, заложенные внутрь статистических тестов. Когда мы проводим расчет, мы получаем несколько цифр, одна из них, про которую все наверняка уже слышали и к которой часто формируется благовейный трепет – p-value. На самом деле, это только одна из связки цифр, которые нужны нам для вывода, сама по себе в вакууме она бессмысленна. Но в связке с другими цифрами она дает нам возможность понять, какова вероятность (p for probability) получить результат, который мы получили, в генеральной совокупности? И если по условиям теста полученная вероятность нас устраивает, мы делаем вывод. Пройдемся по шагам этого вывода. Алгоритм NHST Формулируем эмпирическую гипотезу (это мы уже сделали выше) Формулируем нулевую \\(H_0\\) и альтернативную \\(H_1\\) гипотезы. Для того, чтобы провести статистический тест, нужно определить еще статистическую гипотезу – тестируемое утверждение об отсутствии различий между группами (если гипотеза подразумевает сравнение групп) или об отсутствии связи между переменнами (если гипотеза про связь). Это \\(H_0\\), нулевая гипотеза, которую мы пытаемся опровергнуть в статистическом тестировании (да, именно опровергнуть, а не подтвердить – выводы, которые мы можем сделать отноосительно нулевой гипотезы – только отвергнуть или не отвергнуть, не можем подтвердить ее и принять). Противоположная к нулевой гипотезе – альтернативная гипотеза, \\(H_1\\). Это статистическая гипотеза, противоположная \\(H_0\\), о разнице между группами или о наличии связи. Удобно, когда она тоже сформулирована, чтобы всем придерживаться одного языка статистических тестов. Выбираем статистический критерий для проверки (t-test, Wilcoxon/Mann–Whitney–test, ANOVA, lm) – об этом речь как раз пойдет чуть ниже. Выбираем условия, при котором будем рассчитывать статистический критерий – уровень значимости и статистическую мощность. Это два одних их самых важных параметров в тестировании гипотез. Эти понятия задают вероятностные рамки, в которых мы будем проводить тест – а именно вероятности получить значимый результат (различия или связь), если его на самом нет в генеральной совокупности (ошибка первого рода) и вероятность получить незначимый результат, если его на самом деле нет в генеральной совокупности (ошибка второго рода), Скорее всегоо, вы уже сталкивались с такой таблицей: Другой популярный вариант для объяснения ошибок первого и второго рода: Вероятность, при которой в генеральной совокупности нет разницы между группами или связи, но мы получили ее на наших данных – это и есть уровень значимости, который мы задаем сами. А вероятность, при которой в генеральной совокупности есть разница между группами или связь, но мы не получили ее на наших данных – это 1 - статистическая мощность теста. Уровень значимости \\(\\alpha\\) – это уровень вероятности, при достижении которого мы будем считать, что нулевая гипотеза \\(H_0\\) подтвердилась, и значимых различий или связи между переменными нет. Это просто значение из пространства вероятностей получить значимый результат случайным образом, при условии, что его на самом деле нет в генеральноой совокупности. Психологи просто выбрали значение \\(\\alpha = 0.05\\) и решили, что 5% ложноположительных результатов в психологии – подходящий вариант (сейчас идет большая дискуссия, так ли это). А если мы возьмем, например, физику элементарных частиц, то здесь речь об открытии новой частиц идет только на уровне \\(\\alpha = 0.000001\\)! Уровень статистической мощности (statistical power) – это положительная метрика, уровень вероятности, при котором мы гарантируем, что если различия между группами или связь между переменными есть в генеральной совокупности, то мы сможем найти ее на наших данных при помощи нашего статистического теста. Если смотреть на таблицу ошибок первого и второго, статистическая мощность это \\(1 - \\beta\\), 1 - вероятность ошибки второго рода, не найти значимый эффект, если он есть. Статистическая мощность и вероятность ошибки второг орода – противоположные понятия, в суммме дают 1. В психологии конвенционально сложилось, что всего статистическую мощность принимают на уровне \\(power = 0.8\\) Считаем, сколько данных нужно собрать при выбранном статистическом тесте, выбранном уровне значимости \\(\\alpha\\) и выбранной статистической мощности \\(power\\). Это можно рассчитать в Gpower https://www.psychologie.hhu.de/arbeitsgruppen/allgemeine-psychologie-und-arbeitspsychologie/gpower или в R Проводим выбранный статистический тест: получаем статистику и p-value. Сравниваем p-value с выбранным уровнем значимости α 5.2 Выбор статистических методов для разных гипотез Итак, давайте попробуем разобраться получить ответы на вопросы о наших гипотезах. Гипотезу 1 мы сводили к нескольким вариантам: a) \"студенты возраста 15, 16, 17 лет будут выбирать меньшие значения переменной Walc, чем студенты 18 лет и старше\" b) \"студенты возраста 15 лет будут выбирать меньшие значения переменной Walc, чем студенты 16 лет и старше Как можно их проверить? Это звучит как тест-сравнение двух или нескольких средних по позрастам, 15-17 лет и 18-22 (первый вариант) и 15 лет и 16-22 года (второй вариант). Гипотезу 2 будем проверять в виде: Чем ниже студенты оценивают качества семейных отношений famrel, тем выше они отмечают частоту употребления алкоголя Walc Здесь у нас нет групп, мы проверяем гипотезу о наличии связи между переменными (условно – чем больше значение НП, тем больше или меньше значение ЗП, с ростом НП также происходят изменения и в ЗП) Гипотеза 3: Студенты, у кого было много пропусков (переменная absences_mat или absences_por, высокие значения), будут иметь более низкий средний балл (среднее из переменных G1_mat, G2_mat, G3_mat или G1_por, G2_por, G3_por -- низкие значения) Как понять, какой тест выбрать? Это, наверное, один из самых сложных вопросов в статистике. Вопросы, которые влияют на принятие решения относительно статистического теста: Зависимая переменная непрерывная (интервальная шкала или шкала отношений) или категориальная / дискретная (номинативная или порядковая шкала)? Если ЗП непрерывная – она описывается параметрическим (чаще всего нормальным) распределением? (определяется чаще “на глаз” по графику плотности вероятности или QQ-графиками, тесты на нормальность почти всегда будут давать негативный результат из-за чувствительности и поэтому в современном анализе данных используются мало) Сколько независимых переменных? НП непрерывные (интервальная и шкала отношений) или категориальные / дискретные (номинативная и порядковая)? Если НП категориальные и мы сравниваем группы – данные в группах зависимы или нет? Если нет, как сильно отличаются данные в группах, можем ли сказать, что дисперсия ЗП примерно одинакова в группах или нет? (равенство дисперсий называется Homogeneity of Variance, проверяется с помощью Levene’s test) Есть большое количество схем, но обычно они сильно перегруженны и сложны в использовании, больше путают, чем помогают. Но я зачем-то все равно решила попробовать нарисовать свою, и вот результат: https://miro.com/app/board/uXjVOxmKhr8=/?share_link_id=245423331470 Здесь не все возможные методы статистической проверки гипотез. Однако, скорее всегоо, тут отображены большинство методов, которые могут вам понадобиться в психологических исследованиях. Надеюсь, вы сможете разобраться, и вам будет полезно Эти же методы списком: ЗП количественная, непрерывная, и одна НП, количественная, непрерывная – корреляция Пирсона (Pearson correlation) или линейная регрессия (linear regression). ЗП количественная, непрерывная, и две и более НП, количественные, непрерывные – множественная линейная регрессия (multiple linear regression). ЗП количественная, непрерывная, и параметрическая, и одна НП, категориальная, дискретная. Группы НЕзависимые – independent t-test. ЗП количественная, непрерывная, и параметрическая, и одна НП, категориальная, дискретная. Группы зависимые – paired t-test. ЗП порядковая или НЕпараметрическая, и одна НП, категориальная, дискретная или количественная, непрерывная. Ассоциативная связь – корреляция Спирмена (Spearman correlation). Если группы, НЕзависимые – Mann-Whitney test. ЗП порядковая или НЕпараметрическая, и одна НП, категориальная, дискретная или количественная, непрерывная. Ассоциативная связь – корреляция Спирмена (Spearman correlation). Если группы, зависимые – Wilcoxon test. ЗП количественная, непрерывная, и параметрическая, и две и более НП, категориальные, дискретные. Группы НЕзависимые – ANOVA. ЗП количественная, непрерывная, и параметрическая, и две и более НП, категориальные, дискретные. Группы зависимые – repeated-measurment ANOVA. ЗП порядковая или НЕпараметрическая, и две и более НП, категориальные, дискретные. Группы независимые – Kruskal-Wallis test. ЗП порядковая или НЕпараметрическая, и две и более НП, категориальные, дискретные. Группы зависимые – Friedman test. ЗП категориальная, может принимать два значения, и одна НП, количественная, непрерывная – логистическая регрессия (logistic regression) ЗП категориальная, может принимать два значения, и две и более НП, количественные, непрерывные – множественная логистическая регрессия (multiple logistic regression) ЗП категориальная, может принимать два значения, и одна НП, категориальная, дискретная. Группы НЕзависимые – Fisher’s test (Chi-square test). ЗП категориальная, может принимать два значения, и одна НП, категориальная, дискретная. Группы зависимые – McNemar’s test. ЗП категориальная, может принимать БОЛЕЕ двух значениq, и одна или более НП, количественных, непрерывных – мультиномиальная логистическая регрессия (Multinomial logistic regression, multivariate logistic regression) В целом, если разобраться в тестах не получилось, ответы на эти вопросы помогают сформировать запрос и дальше отправиться в гугл или к коллегам с конкретным вопросом, например какой тест использовать для сравнения двух независимых групп в количественной шкале? Я подразумевала, что можно почитать статьи из поисковой выдачи, но оказалось, что гугл даже научился иногда отвечать на этот вопрос… "],["выбор-среды-анализа-данных.html", " 6 Выбор среды анализа данных", " 6 Выбор среды анализа данных Выбрана среда для анализа данных и конкретная функция под выбранный статистический критерий (или несколько функций) (если нужно - установлен пакет для выбранных функций) Как вы уже догадались, я обрабатываю данные в R. Этот сайт, кстати, тоже сделан на языке R в RStudio с помощью текстовой разметки RMarkdown. Об этом мы тоже немного поговорим на последнем семинаре, когда будем говорить про презентации результатов "],["препроцессинг.html", " 7 Препроцессинг", " 7 Препроцессинг Собранные данные предобработаны и приведены в вид, к которому можно применить выбранный статистический критерий и выполнить выбранную функцию Ура, наконец-то мы на этапе, где уже собраны данные! Я немного предобработаю их, чтобы дальше было проще с ними работать. Не недооценивайте предобработку: опытные аналитики говорят, что примерно 80%-90% анализа данных составляет предобработка, и только оставшееся – собственно вычисление ключевой функции (статистического критерия) и получение целевой цифры. studens_mat %&gt;% full_join(studens_por, by = c(&quot;school&quot;,&quot;sex&quot;,&quot;age&quot;,&quot;address&quot;,&quot;famsize&quot;,&quot;Pstatus&quot;,&quot;Medu&quot;,&quot;Fedu&quot;, &quot;Mjob&quot;,&quot;Fjob&quot;,&quot;reason&quot;, &quot;guardian&quot;, &quot;traveltime&quot;,&quot;studytime&quot;, &quot;failures&quot;, &quot;schoolsup&quot;, &quot;famsup&quot;, &quot;activities&quot;, &quot;nursery&quot;, &quot;higher&quot;, &quot;internet&quot;, &quot;romantic&quot;, &quot;famrel&quot;, &quot;freetime&quot;, &quot;goout&quot;, &quot;Dalc&quot;, &quot;Walc&quot;, &quot;health&quot;)) -&gt; students #объединяю две таблички в одну students %&gt;% mutate(&quot;student&quot; = paste0(&quot;id&quot;, row_number()), .before = &quot;school&quot;) -&gt; students #добавляю колонку с айдишником и перезаписываю результат в датасет students %&gt;% drop_na() -&gt; students #пропускаю строки с NA и перезаписываю результат в датасет students %&gt;% mutate(G_mat = rowMeans(select(., c(G1_mat, G2_mat, G3_mat))), G_por = rowMeans(select(., c(G1_por, G2_por, G3_por)))) -&gt; students kable(students[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) #здесь я посчитала средний балл по трем баллам по математике G_mat и португальскому G_por student school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat paid_por absences_por G1_por G2_por G3_por G_mat G_por id1 GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 no 4 0 11 11 5.666667 7.333333 id2 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 no 2 9 11 11 5.333333 10.333333 id4 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 no 0 14 14 14 14.666667 14.000000 id5 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 no 0 11 13 13 8.666667 12.333333 id6 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 no 6 12 12 13 15.000000 12.333333 id7 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 no 0 13 12 13 11.666667 12.666667 id8 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 no 2 10 13 13 5.666667 12.000000 id9 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 no 0 15 16 17 17.666667 16.000000 id10 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 no 0 12 12 13 14.666667 12.333333 id11 GP F 15 U GT3 T 4 4 teacher health reputation mother 1 2 0 no yes yes no yes yes yes no 3 3 3 1 2 2 0 10 8 9 no 2 14 14 14 9.000000 14.000000 "],["описательные-статистики-и-визуализации.html", " 8 Описательные статистики и визуализации 8.1 Таблицы и пропорции 8.2 Описательные визуализации 8.3 Визуализации статистического вывода, которые тоже помогают понять данные 8.4 Визуализации в R с помощью ggplot2 8.5 Визуализации данных в системах для построения дашбордов", " 8 Описательные статистики и визуализации Выбранные для анализа предобработанные переменные исследованы описательными статистиками и предварительно визуализированы для общего понимания) Теперь давайте поизучаем данные. Как ведут себя выбранные для анализа переменные? Что это за данные: в какой шкале они записаны, непрерывные или дискретные? Каковы максимальные и миниамальные значения? А самые встречающиеся? Какова вообще встречаемость разных значений? Такое описание данных называется описательными статистиками (descipritve stats), потому что, как уже понятно из названия, описывает наши данные. Это идет в разрез со статистиками вывода (inferential stats), когда мы делаем выводы относительно гипотез – сравнение двух выборок с определением статистической значимости результатов, корреляционный тест, определение коэффциентов в линейной регрессии и так далее. Сейчас нас интересует исследование самих переменных, поэтому речь здесь пойдет об описательных статистиках. 8.0.1 Описательные статистики Переменные, которые нас интересовали – для одной гипотезы это возраст (Age) и употребление алкоголя на выходных (Walc), для другой – отношения в семье (famrel) и употребление алкоголя в рабочие дни (Dalc). Рассмотрим их подробнее. И еще дл summary(students$age) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 15.00 16.00 16.00 16.52 17.00 22.00 Более детальный способ – с помощью дополнительных пакетов, например, Skimr и функции skim skimr::skim(students$age) Table 8.1: Data summary Name students$age Number of rows 320 Number of columns 1 _______________________ Column type frequency: numeric 1 ________________________ Group variables None Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist data 0 1 16.52 1.14 15 16 16 17 22 ▇▅▃▁▁ skimr::skim(students) Table 8.1: Data summary Name students Number of rows 320 Number of columns 41 _______________________ Column type frequency: character 19 numeric 22 ________________________ Group variables None Variable type: character skim_variable n_missing complete_rate min max empty n_unique whitespace student 0 1 3 5 0 320 0 school 0 1 2 2 0 2 0 sex 0 1 1 1 0 2 0 address 0 1 1 1 0 2 0 famsize 0 1 3 3 0 2 0 Pstatus 0 1 1 1 0 2 0 Mjob 0 1 5 8 0 5 0 Fjob 0 1 5 8 0 5 0 reason 0 1 4 10 0 4 0 guardian 0 1 5 6 0 3 0 schoolsup 0 1 2 3 0 2 0 famsup 0 1 2 3 0 2 0 paid_mat 0 1 2 3 0 2 0 activities 0 1 2 3 0 2 0 nursery 0 1 2 3 0 2 0 higher 0 1 2 3 0 2 0 internet 0 1 2 3 0 2 0 romantic 0 1 2 3 0 2 0 paid_por 0 1 2 3 0 2 0 Variable type: numeric skim_variable n_missing complete_rate mean sd p0 p25 p50 p75 p100 hist age 0 1 16.52 1.14 15 16 16.00 17.00 22.00 ▇▅▃▁▁ Medu 0 1 2.87 1.07 0 2 3.00 4.00 4.00 ▁▂▆▅▇ Fedu 0 1 2.62 1.09 0 2 3.00 4.00 4.00 ▁▅▇▇▇ traveltime 0 1 1.43 0.69 1 1 1.00 2.00 4.00 ▇▃▁▁▁ studytime 0 1 2.08 0.87 1 1 2.00 3.00 4.00 ▅▇▁▃▁ failures 0 1 0.08 0.39 0 0 0.00 0.00 3.00 ▇▁▁▁▁ famrel 0 1 3.99 0.89 1 4 4.00 5.00 5.00 ▁▁▂▇▅ freetime 0 1 3.20 0.97 1 3 3.00 4.00 5.00 ▁▃▇▆▂ goout 0 1 3.07 1.10 1 2 3.00 4.00 5.00 ▂▆▇▅▃ Dalc 0 1 1.44 0.88 1 1 1.00 2.00 5.00 ▇▂▁▁▁ Walc 0 1 2.22 1.26 1 1 2.00 3.00 5.00 ▇▅▃▂▁ health 0 1 3.52 1.42 1 3 4.00 5.00 5.00 ▃▂▅▃▇ absences_mat 0 1 5.41 7.84 0 0 4.00 7.25 75.00 ▇▁▁▁▁ G1_mat 0 1 11.29 3.20 5 9 11.00 14.00 19.00 ▃▇▇▅▂ G2_mat 0 1 11.18 3.67 0 9 11.00 14.00 19.00 ▁▂▇▇▂ G3_mat 0 1 11.04 4.30 0 9 11.00 14.00 20.00 ▁▃▇▆▂ absences_por 0 1 3.25 4.56 0 0 2.00 4.00 32.00 ▇▁▁▁▁ G1_por 0 1 12.39 2.56 0 11 12.00 14.00 19.00 ▁▁▅▇▂ G2_por 0 1 12.57 2.42 5 11 12.00 14.00 19.00 ▁▃▇▅▁ G3_por 0 1 12.88 2.89 0 11 13.00 15.00 19.00 ▁▁▅▇▃ G_mat 0 1 11.17 3.56 2 9 11.00 13.67 19.33 ▁▃▇▅▂ G_por 0 1 12.62 2.51 4 11 12.67 14.33 18.67 ▁▂▇▆▂ 8.1 Таблицы и пропорции table(students$age, students$Walc) ## ## 1 2 3 4 5 ## 15 43 11 10 5 2 ## 16 37 20 12 14 8 ## 17 24 20 24 12 7 ## 18 23 18 13 8 2 ## 19 1 2 3 0 0 ## 22 0 0 0 0 1 round(prop.table(table(students$age, students$Walc), 1), 2) ## ## 1 2 3 4 5 ## 15 0.61 0.15 0.14 0.07 0.03 ## 16 0.41 0.22 0.13 0.15 0.09 ## 17 0.28 0.23 0.28 0.14 0.08 ## 18 0.36 0.28 0.20 0.12 0.03 ## 19 0.17 0.33 0.50 0.00 0.00 ## 22 0.00 0.00 0.00 0.00 1.00 8.2 Описательные визуализации Какой график построить для исследования данных внутри одной переменной? Гистограмма Если переменная количественная и дискретная или строковая – гистограмму (частота встречаемости отдельных значений). hist(students$Walc) students %&gt;% ggplot(aes(x=Walc)) + geom_histogram(binwidth = 0.5) + theme_minimal() Другой вариант визуализации гистограммы – с помощью барплота. Барплоты students %&gt;% ggplot(aes(x=Walc)) + geom_bar(aes(fill = as.factor(Walc)), stat = &#39;count&#39;) + theme_minimal() Сейчас мы нарисовали точно такую же диаграмму, но с помощью атрибута geom_bar вместо geom_histogram функции ggplot. Гистограммного вида мы добились с помощью значения count атрибута stat. Этот атрибут означает, что вместо барплота, который строится по двум переменным x и y, мы будем строить график количества значений (гистограмму) для одной переменной x. Другой популярный вариант значения атрибута stat - значение identity, буквально означает “строим барплот как есть, по двум переменным”: students %&gt;% ggplot(aes(x=as.factor(age), y = Walc)) + geom_bar(aes(x=as.factor(age), y = as.factor(Walc), fill = as.factor(Walc)), stat = &#39;identity&#39;) + theme_minimal() students %&gt;% ggplot(aes(x=age, y = Walc)) + geom_bar(aes(x=age, y = Walc), stat = &#39;identity&#39;) + theme_minimal() Здесь я еще сделала преобразование as.factor для переменной age. students %&gt;% ggplot(aes(x = as.factor(age), y = as.factor(Walc))) + geom_bar(aes(fill = as.factor(Walc)), stat = &#39;identity&#39;) + theme_minimal() График плотности вероятности Если переменная количественная, и данные непрерывны – график плотности (вероятности). В нашем датасете на количественную непрерывную переменную больше всего похожи пропуски занятий students %&gt;% ggplot(aes(x=absences_por)) + geom_density() + theme_minimal() students %&gt;% ggplot(aes(x=absences_mat)) + geom_density() + theme_minimal() students %&gt;% ggplot(aes(x=G_por)) + geom_density() + theme_minimal() 8.3 Визуализации статистического вывода, которые тоже помогают понять данные Хорошо, посмотрели, как ведут себя данные в наших целевых переменных: что из себя представляют, каков характер распредедения. А что, если нам интересно посмотреть переменные не по одной, а в зависимости друг от друга? Если взять две переменные, по осям x и y? Такие графики мы обычно строим, когда нужно визуализироовать результаты какого-либо статистического тестирования: сравнения двух средних, поиска корреляции и т.д. Поэтому я назвала этот пункт “визуализациями статистического вывода”. Однако, сами статистические тесты сейчас я не провожу, но мне интересно взглянуть на данные, как они ведут себя уже не сами по себе, а в соответствии с выдвинутыми гипотезами? Диаграмма рассеяния students %&gt;% ggplot(aes(x = absences_mat, y = G_mat)) + geom_point(aes(colour = absences_mat)) + theme_minimal() Коррелограмма Допустим, мы хотим посмотреть корреляцию всех количественных переменных соо всеми (никогда так не делайте – вы обязательно найдетете какую-нибудь связь, возможно из-за статистической ошибки и несмотря на то, что не искали эту связь, и соблазн выдать ее за свою гипотезу будет слишком велик). students %&gt;% select(traveltime, studytime, famrel, freetime, Dalc, Walc, health, absences_mat, absences_por, G_mat, G_por) %&gt;% as.matrix() -&gt; students_numeric_matrix students_numeric_matrix %&gt;% cor() %&gt;% round(2) ## traveltime studytime famrel freetime Dalc Walc health ## traveltime 1.00 -0.10 -0.03 -0.06 0.16 0.11 0.02 ## studytime -0.10 1.00 0.00 -0.09 -0.17 -0.23 -0.04 ## famrel -0.03 0.00 1.00 0.09 -0.06 -0.13 0.14 ## freetime -0.06 -0.09 0.09 1.00 0.20 0.12 0.07 ## Dalc 0.16 -0.17 -0.06 0.20 1.00 0.65 0.06 ## Walc 0.11 -0.23 -0.13 0.12 0.65 1.00 0.07 ## health 0.02 -0.04 0.14 0.07 0.06 0.07 1.00 ## absences_mat 0.00 -0.08 -0.05 -0.05 0.15 0.21 0.01 ## absences_por 0.05 -0.13 -0.03 -0.01 0.11 0.15 0.00 ## G_mat -0.16 0.09 -0.05 -0.02 -0.07 -0.06 -0.06 ## G_por -0.18 0.24 -0.03 -0.10 -0.27 -0.18 -0.16 ## absences_mat absences_por G_mat G_por ## traveltime 0.00 0.05 -0.16 -0.18 ## studytime -0.08 -0.13 0.09 0.24 ## famrel -0.05 -0.03 -0.05 -0.03 ## freetime -0.05 -0.01 -0.02 -0.10 ## Dalc 0.15 0.11 -0.07 -0.27 ## Walc 0.21 0.15 -0.06 -0.18 ## health 0.01 0.00 -0.06 -0.16 ## absences_mat 1.00 0.56 -0.06 -0.13 ## absences_por 0.56 1.00 -0.12 -0.10 ## G_mat -0.06 -0.12 1.00 0.59 ## G_por -0.13 -0.10 0.59 1.00 Или более красивый и понятный вариант с помощью пакета Hmisc library(&quot;Hmisc&quot;) ## Loading required package: lattice ## Loading required package: survival ## Loading required package: Formula ## ## Attaching package: &#39;Hmisc&#39; ## The following objects are masked from &#39;package:dplyr&#39;: ## ## src, summarize ## The following objects are masked from &#39;package:base&#39;: ## ## format.pval, units students_numeric_matrix %&gt;% rcorr() ## traveltime studytime famrel freetime Dalc Walc health ## traveltime 1.00 -0.10 -0.03 -0.06 0.16 0.11 0.02 ## studytime -0.10 1.00 0.00 -0.09 -0.17 -0.23 -0.04 ## famrel -0.03 0.00 1.00 0.09 -0.06 -0.13 0.14 ## freetime -0.06 -0.09 0.09 1.00 0.20 0.12 0.07 ## Dalc 0.16 -0.17 -0.06 0.20 1.00 0.65 0.06 ## Walc 0.11 -0.23 -0.13 0.12 0.65 1.00 0.07 ## health 0.02 -0.04 0.14 0.07 0.06 0.07 1.00 ## absences_mat 0.00 -0.08 -0.05 -0.05 0.15 0.21 0.01 ## absences_por 0.05 -0.13 -0.03 -0.01 0.11 0.15 0.00 ## G_mat -0.16 0.09 -0.05 -0.02 -0.07 -0.06 -0.06 ## G_por -0.18 0.24 -0.03 -0.10 -0.27 -0.18 -0.16 ## absences_mat absences_por G_mat G_por ## traveltime 0.00 0.05 -0.16 -0.18 ## studytime -0.08 -0.13 0.09 0.24 ## famrel -0.05 -0.03 -0.05 -0.03 ## freetime -0.05 -0.01 -0.02 -0.10 ## Dalc 0.15 0.11 -0.07 -0.27 ## Walc 0.21 0.15 -0.06 -0.18 ## health 0.01 0.00 -0.06 -0.16 ## absences_mat 1.00 0.56 -0.06 -0.13 ## absences_por 0.56 1.00 -0.12 -0.10 ## G_mat -0.06 -0.12 1.00 0.59 ## G_por -0.13 -0.10 0.59 1.00 ## ## n= 320 ## ## ## P ## traveltime studytime famrel freetime Dalc Walc health ## traveltime 0.0651 0.6269 0.3188 0.0038 0.0597 0.7100 ## studytime 0.0651 0.9804 0.1011 0.0020 0.0000 0.4651 ## famrel 0.6269 0.9804 0.1044 0.3062 0.0238 0.0124 ## freetime 0.3188 0.1011 0.1044 0.0002 0.0333 0.2061 ## Dalc 0.0038 0.0020 0.3062 0.0002 0.0000 0.2849 ## Walc 0.0597 0.0000 0.0238 0.0333 0.0000 0.2088 ## health 0.7100 0.4651 0.0124 0.2061 0.2849 0.2088 ## absences_mat 0.9792 0.1414 0.3914 0.4091 0.0066 0.0002 0.8290 ## absences_por 0.3328 0.0157 0.5984 0.8386 0.0546 0.0070 0.9847 ## G_mat 0.0050 0.1221 0.3352 0.7490 0.2238 0.3051 0.2539 ## G_por 0.0014 0.0000 0.5365 0.0745 0.0000 0.0010 0.0040 ## absences_mat absences_por G_mat G_por ## traveltime 0.9792 0.3328 0.0050 0.0014 ## studytime 0.1414 0.0157 0.1221 0.0000 ## famrel 0.3914 0.5984 0.3352 0.5365 ## freetime 0.4091 0.8386 0.7490 0.0745 ## Dalc 0.0066 0.0546 0.2238 0.0000 ## Walc 0.0002 0.0070 0.3051 0.0010 ## health 0.8290 0.9847 0.2539 0.0040 ## absences_mat 0.0000 0.2991 0.0195 ## absences_por 0.0000 0.0369 0.0740 ## G_mat 0.2991 0.0369 0.0000 ## G_por 0.0195 0.0740 0.0000 Визуализируем матрицу корреляций в коррелограмму library(corrplot) ## corrplot 0.90 loaded corrplot(cor(students_numeric_matrix), method=&quot;circle&quot;) # corrplot(rcorr(students_numeric_matrix)$r, p.mat = rcorr(students_numeric_matrix)$P, sig.level = 0.05, insig = &quot;blank&quot;) heatmap(x = cor(students_numeric_matrix)) Боксплот и вайолин плот Если нам интересно посмотреть значения в группах, можно построить боксплот (тот самый ящик с усами) students %&gt;% ggplot(aes(x=Walc, y = age)) + geom_boxplot(aes(fill = as.factor(Walc))) + theme_minimal() Или даже лучше и информативнее – вайолин плот (повернутое на бок распределение плотности вероятности, зачастую вместе с ящиком с усами.) students %&gt;% ggplot(aes(x=Walc, y = age)) + geom_violin(aes(fill = as.factor(Walc))) + theme_minimal() Визуализация линейной регрессии students %&gt;% # slice(absences_mat&lt;40) %&gt;% ggplot(aes(x=absences_mat, y = G_mat)) + geom_point(aes(colour = absences_mat)) + geom_smooth(method=&quot;lm&quot;) + theme_minimal() ## `geom_smooth()` using formula &#39;y ~ x&#39; Визуализация логистической регрессии 8.4 Визуализации в R с помощью ggplot2 Грамматика графиков (The Crammar of Graphics) Большую часть этих графиков я визуализировала с помощью пакета ggplot2. Пару слов о том, как он работает. https://ggplot2.tidyverse.org/ По сути, это – универсальный конструктор графиков. Мы подгружаем данные, а дальше, послойно, собираем на них график как конструктор, накладывая каждый слой на предыдущий. В парадигме грамматики графиков любой график состоит из нескольких слоев: первый слой – данные, передаем их чаще всего первой строчкой с объявлением функции ggplot() geom (геометрический объект), обычно второй строчкой: geom_hist, geom_bar, geom_point, geom_line aes (эстетики) - аргумент geom или ggplot – оси x и y, цвета (для обводки и точек цвет задает через color, для заливки и объектов, имеющих плозадь – через fill). Пишут внутри aes() в скобках внутри геома или ggplot. Задавая аргументы-эстетики как бы натягиваем наши данные на координатную ось и геометрический объект, задаем правила преообразования данных в график. Это были обязательные слои построения графиков. Есть еще вспомогательные, которые доступны не для всех геомов: stat (статистические трансформации) - используется в основном для превращения барплота в гистограмму (stat=“count”) facets - позволяет отобразить график в фасетах themes - настраивает визуальные темы (вне зависимости от данных и геома: цвет фона графика, прозрачность подложки, толщина и цвет координатной сетки и т.д.) 8.5 Визуализации данных в системах для построения дашбордов https://www.tableau.com/ https://www.tableau.com/data-insights/dashboard-showcase https://www.datawrapper.de/ "],["расчет-статистического-метода-и-интерпретация-результатов.html", " 9 Расчет статистического метода и интерпретация результатов 9.1 Проверка статистичкских гипотез (NHST, Null Hypothesis Statistical Testing) 9.2 Расчет разных статистических методов для проверки гипотез", " 9 Расчет статистического метода и интерпретация результатов Проведен расчет выбранного статистического критерия с помощью выбранной функции Вид полученных результатов понятен для интерпретации, и результаты согласуются с представлением о том, как они должны выглядеть Результаты проинтепретированы и сделан вывод относительно статистической и экспериментальной гипотез Итак, мы шли через весь чек-лист и готовились к самому главному – расчету выбранного статистического теста. Он даст нам несколько заветных цифр (значение самой статистики или коэффциента и p-value), по которым мы можем сделать вывод о связи между НП и ЗП, о различиях между группами или о вкладе какого-либо фактора в изменчивость наблюдаемых проявлений, в завимости от гипотезы. Что мы сделали (в идеале): Сформулировали теоретическую гипотезу (даже несколько) Выбрали исследовательский метод, в котором ее можно проверить Перевели теоретическую гипотезу на язык исследования и сформулировали эмпирическую гипотезу Выбрали статистический метод, которым будем проверять гипотезу Получили представление, как будут выглядеть собранные данные после проведения исследования Собрали данные Предобработали данные Посмотрели на ЗП и НП, участвующие в нашей гипотезе, посчитали для них описательные статисики, сделали описательные визуализации, сравнили их с нашими ожиданиями Теперь можем проводить расчет статистического метода! Для начала давайте вспомним, что мы делаем, когда рассчитываем статистические методы для проверки гипотез 9.1 Проверка статистичкских гипотез (NHST, Null Hypothesis Statistical Testing) 9.2 Расчет разных статистических методов для проверки гипотез Начнем проверять с третьей гипотезы, чтобы идти от простого статистического метода к более сложным. Первый вариант гипотезы 3 – о наличии линейной связи, проверяется корреляционным тестом и обычной линейной регрессией. Гипотеза 3_a Чем больше пропусков занятий, тем более низкий средний балл по предмету Проверяем корреляцию НП и ЗП: cor.test(~G_mat + absences_mat, data = students, method = &#39;pearson&#39;) ## ## Pearson&#39;s product-moment correlation ## ## data: G_mat and absences_mat ## t = -1.0401, df = 318, p-value = 0.2991 ## alternative hypothesis: true correlation is not equal to 0 ## 95 percent confidence interval: ## -0.1668011 0.0517444 ## sample estimates: ## cor ## -0.05822595 # cor.test(students$G_mat, students$absences_mat, method = &#39;pearson&#39;) эта запись эквивалентна предыдущей cor.test(~G_por + absences_por, data = students, method = &#39;pearson&#39;) ## ## Pearson&#39;s product-moment correlation ## ## data: G_por and absences_por ## t = -1.7923, df = 318, p-value = 0.07404 ## alternative hypothesis: true correlation is not equal to 0 ## 95 percent confidence interval: ## -0.207367985 0.009745291 ## sample estimates: ## cor ## -0.1000016 Гипотеза 3_b Студенты, у кого было от 0 до 5 пропусков, от 6 до 15 и больше 15 будут иметь разный средний балл по предмету Эта гипотеза предполагает сравнение трех групп, тестируем ANOVA. Сначала создадим новые переменные, чтобы перекодировать пропуски в группы: students %&gt;% mutate(ansences_mat_groups = ifelse(absences_mat &lt;=5, &quot;less&quot;, ifelse(absences_mat &lt;=15, &quot;middle&quot;, &quot;more&quot;))) %&gt;% mutate(ansences_por_groups = ifelse(absences_por &lt;=5, &quot;less&quot;, ifelse(absences_por &lt;=15, &quot;middle&quot;, &quot;more&quot;))) -&gt; students kable(students[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) student school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat paid_por absences_por G1_por G2_por G3_por G_mat G_por ansences_mat_groups ansences_por_groups id1 GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 no 4 0 11 11 5.666667 7.333333 middle less id2 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 no 2 9 11 11 5.333333 10.333333 less less id4 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 no 0 14 14 14 14.666667 14.000000 less less id5 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 no 0 11 13 13 8.666667 12.333333 less less id6 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 no 6 12 12 13 15.000000 12.333333 middle middle id7 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 no 0 13 12 13 11.666667 12.666667 less less id8 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 no 2 10 13 13 5.666667 12.000000 middle less id9 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 no 0 15 16 17 17.666667 16.000000 less less id10 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 no 0 12 12 13 14.666667 12.333333 less less id11 GP F 15 U GT3 T 4 4 teacher health reputation mother 1 2 0 no yes yes no yes yes yes no 3 3 3 1 2 2 0 10 8 9 no 2 14 14 14 9.000000 14.000000 less less Применим тест Классическое выполнение ANOVA в R: model_abs_mat &lt;- aov(G_mat ~ ansences_mat_groups, data = students) summary(model_abs_mat) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ansences_mat_groups 2 22 10.87 0.857 0.425 ## Residuals 317 4021 12.68 model_abs_por &lt;- aov(G_mat ~ ansences_por_groups, data = students) summary(model_abs_por) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ansences_por_groups 2 57 28.63 2.277 0.104 ## Residuals 317 3985 12.57 ANOVA в R c помощью более тонко настраеваемо1: model_abs_mat &lt;- aov(G_mat ~ ansences_mat_groups, data = students) summary(model_abs_mat) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ansences_mat_groups 2 22 10.87 0.857 0.425 ## Residuals 317 4021 12.68 model_abs_por &lt;- aov(G_mat ~ ansences_por_groups, data = students) summary(model_abs_por) ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## ansences_por_groups 2 57 28.63 2.277 0.104 ## Residuals 317 3985 12.57 Наши гипотезы трансформировались в: Гипотеза 1_a: студенты возраста 15, 16, 17 лет будут выбирать меньшие значения переменной Walc, чем студенты 18 лет и старше Гипотеза 1_b: студенты возраста 15 лет будут выбирать меньшие значения переменной Walc, чем студенты 16 лет и старше Чтобы их проверить, перекодируем переменную age в новые переменные: students %&gt;% mutate(adult = ifelse(age &gt;= 18, &quot;yes&quot;, &quot;no&quot;)) %&gt;% mutate(`15th` = ifelse(age == 15, &quot;yes&quot;, &quot;no&quot;)) -&gt; students #создали переменную, которая делит студентов на совершеннолетних и нет kable(students[1:10,]) %&gt;% scroll_box(width = &quot;100%&quot;) student school sex age address famsize Pstatus Medu Fedu Mjob Fjob reason guardian traveltime studytime failures schoolsup famsup paid_mat activities nursery higher internet romantic famrel freetime goout Dalc Walc health absences_mat G1_mat G2_mat G3_mat paid_por absences_por G1_por G2_por G3_por G_mat G_por ansences_mat_groups ansences_por_groups adult 15th id1 GP F 18 U GT3 A 4 4 at_home teacher course mother 2 2 0 yes no no no yes yes no no 4 3 4 1 1 3 6 5 6 6 no 4 0 11 11 5.666667 7.333333 middle less yes no id2 GP F 17 U GT3 T 1 1 at_home other course father 1 2 0 no yes no no no yes yes no 5 3 3 1 1 3 4 5 5 6 no 2 9 11 11 5.333333 10.333333 less less no no id4 GP F 15 U GT3 T 4 2 health services home mother 1 3 0 no yes yes yes yes yes yes yes 3 2 2 1 1 5 2 15 14 15 no 0 14 14 14 14.666667 14.000000 less less no yes id5 GP F 16 U GT3 T 3 3 other other home father 1 2 0 no yes yes no yes yes no no 4 3 2 1 2 5 4 6 10 10 no 0 11 13 13 8.666667 12.333333 less less no no id6 GP M 16 U LE3 T 4 3 services other reputation mother 1 2 0 no yes yes yes yes yes yes no 5 4 2 1 2 5 10 15 15 15 no 6 12 12 13 15.000000 12.333333 middle middle no no id7 GP M 16 U LE3 T 2 2 other other home mother 1 2 0 no no no no yes yes yes no 4 4 4 1 1 3 0 12 12 11 no 0 13 12 13 11.666667 12.666667 less less no no id8 GP F 17 U GT3 A 4 4 other teacher home mother 2 2 0 yes yes no no yes yes no no 4 1 4 1 1 1 6 6 5 6 no 2 10 13 13 5.666667 12.000000 middle less no no id9 GP M 15 U LE3 A 3 2 services other home mother 1 2 0 no yes yes no yes yes yes no 4 2 2 1 1 1 0 16 18 19 no 0 15 16 17 17.666667 16.000000 less less no yes id10 GP M 15 U GT3 T 3 4 other other home mother 1 2 0 no yes yes yes yes yes yes no 5 5 1 1 1 5 0 14 15 15 no 0 12 12 13 14.666667 12.333333 less less no yes id11 GP F 15 U GT3 T 4 4 teacher health reputation mother 1 2 0 no yes yes no yes yes yes no 3 3 3 1 2 2 0 10 8 9 no 2 14 14 14 9.000000 14.000000 less less no yes Итак, пойдем по алгоритму. В тесте Гипотезы 1_a ЗП – порядковая, ЗП может принимать 5 значений – значит, я рассматриваю ее как количественную. Далее, одна НП, и наша гипотеза – о сравнении двух групп между собой. Эти группы независимы (тестируются оценки разных студентов, никак не связанных друг с другом). Значит, будем использовать тест Манна-Уитни (Mann-Whitney test) wilcox.test(students$Walc ~ students$adult, paired = FALSE, alternative = &quot;greater&quot;) ## ## Wilcoxon rank sum test with continuity correction ## ## data: students$Walc by students$adult ## W = 8539.5, p-value = 0.676 ## alternative hypothesis: true location shift is greater than 0 В тесте Гипотезы 1_b ЗП – порядковая, ЗП может принимать 5 значений – значит, я рассматриваю ее как количественную. Далее, одна НП, и наша гипотеза – о сравнении двух групп между собой. Эти группы независимы (тестируются оценки разных студентов, никак не связанных друг с другом). Значит, будем использовать тест Манна-Уитни (Mann-Whitney test) wilcox.test(students$Walc ~ students$`15th`, paired = FALSE, alternative = &quot;greater&quot;) ## ## Wilcoxon rank sum test with continuity correction ## ## data: students$Walc by students$`15th` ## W = 11326, p-value = 7.892e-05 ## alternative hypothesis: true location shift is greater than 0 Чем отличаются результаты тестов? Проведем тест для следующей гипотезы. Гипотеза 2 Чем ниже студенты оценивают качество семейных отношений famrel, тем выше они отмечают частоту употребления алкоголя Walc Пойдем также по алгоритму. ЗП – порядковая, ЗП может принимать 5 значений – значит, я рассматриваю ее как количественную. Одна независимая переменная, так же порядковая, то есть точно непараметрическая. Наша гипотеза не о сравнении групп, об ассоциативной (корреляционной) связи. Значит, следует использовать либо ранговую корреляцию Спирмена, либо порядковую логистическую регрессию (если я хочу, чтобы связь имела предсказательную силу). Начнем с простого – корреляции Спирмена cor.test(students$famrel, students$Walc, method = &#39;spearman&#39;) ## Warning in cor.test.default(students$famrel, students$Walc, method = ## &quot;spearman&quot;): Cannot compute exact p-value with ties ## ## Spearman&#39;s rank correlation rho ## ## data: students$famrel and students$Walc ## S = 6173557, p-value = 0.0196 ## alternative hypothesis: true rho is not equal to 0 ## sample estimates: ## rho ## -0.130423 Попробуем порядковую логистическую регрессию ## ## Attaching package: &#39;MASS&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## select ## Call: ## polr(formula = as.factor(Walc) ~ as.factor(famrel), data = students, ## Hess = TRUE) ## ## Coefficients: ## Value Std. Error t value ## as.factor(famrel)2 -0.6749 0.9380 -0.7195 ## as.factor(famrel)3 -0.3941 0.8104 -0.4863 ## as.factor(famrel)4 -0.7474 0.7870 -0.9497 ## as.factor(famrel)5 -1.0775 0.7971 -1.3518 ## ## Intercepts: ## Value Std. Error t value ## 1|2 -1.1787 0.7757 -1.5196 ## 2|3 -0.2620 0.7751 -0.3381 ## 3|4 0.7370 0.7814 0.9432 ## 4|5 1.9655 0.7975 2.4645 ## ## Residual Deviance: 920.8895 ## AIC: 936.8895 И добавим p-value ctable &lt;- coef(summary(famrel_ordered_model)) p &lt;- pnorm(abs(ctable[, &quot;t value&quot;]), lower.tail = FALSE) * 2 ctable &lt;- cbind(ctable, &quot;p value&quot; = p) ctable ## Value Std. Error t value p value ## as.factor(famrel)2 -0.6749367 0.9380228 -0.7195313 0.47181365 ## as.factor(famrel)3 -0.3940742 0.8103672 -0.4862908 0.62676098 ## as.factor(famrel)4 -0.7474178 0.7870231 -0.9496770 0.34227639 ## as.factor(famrel)5 -1.0774883 0.7970952 -1.3517685 0.17644937 ## 1|2 -1.1787296 0.7756805 -1.5196070 0.12860978 ## 2|3 -0.2620218 0.7750710 -0.3380616 0.73531675 ## 3|4 0.7369875 0.7813711 0.9431979 0.34557970 ## 4|5 1.9654590 0.7975037 2.4645141 0.01371992 Гипотеза 3 Чем больше пропусков занятий absences_mat или absences_por, тем ниже средний балл G_mat или G_por ЗП количественная непрерывная, гипотеза о связи и одна НП. Это корреляция Пирсона или обычная линейная регрессия cor.test(students$absences_mat, students$G_mat, alternative = &quot;less&quot;, method = &#39;pearson&#39;) ## ## Pearson&#39;s product-moment correlation ## ## data: students$absences_mat and students$G_mat ## t = -1.0401, df = 318, p-value = 0.1495 ## alternative hypothesis: true correlation is less than 0 ## 95 percent confidence interval: ## -1.00000000 0.03407909 ## sample estimates: ## cor ## -0.05822595 model_Gmat &lt;- lm(students$G_mat ~ students$absences_mat) summary(model_Gmat) ## ## Call: ## lm(formula = students$G_mat ~ students$absences_mat) ## ## Residuals: ## Min 1Q Median 3Q Max ## -9.3130 -2.1013 0.0045 2.4727 8.1262 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 11.31298 0.24196 46.76 &lt;2e-16 *** ## students$absences_mat -0.02645 0.02544 -1.04 0.299 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 3.559 on 318 degrees of freedom ## Multiple R-squared: 0.00339, Adjusted R-squared: 0.0002563 ## F-statistic: 1.082 on 1 and 318 DF, p-value: 0.2991 "],["визуализация-результатов.html", " 10 Визуализация результатов", " 10 Визуализация результатов Результаты визуализированы, так, чтобы их было легче правильно воспринять Несмотря на то, что визуализация результатов стоит последний пунктом, это очень важный этап. Кроме того, он может использоваться и до получения результатов, чтобы прикинуть, какими получатся результаты еще до проведения статистического теста. Визуализации для гипотезы 1 students %&gt;% ggplot(aes(x=adult, y = Walc)) + geom_boxplot(aes(fill = adult)) + theme_minimal() students %&gt;% ggplot(aes(x=`15th`, y = Walc)) + geom_boxplot(aes(fill = `15th`)) + theme_minimal() Визуализации для гипотезы 2 students %&gt;% ggplot(aes(x=famrel, y = Walc)) + geom_point(aes(colour = famrel)) + theme_minimal() Визуализации для гипотезы 3 students %&gt;% ggplot(aes(x=absences_mat, y = G_mat)) + geom_point(aes(colour = absences_mat)) + geom_smooth(method=&quot;lm&quot;) + theme_minimal() ## `geom_smooth()` using formula &#39;y ~ x&#39; Визуализируем матрицу корреляций в коррелограмму library(corrplot) corrplot(cor(students_numeric_matrix), method=&quot;circle&quot;) # corrplot(rcorr(students_numeric_matrix)$r, p.mat = rcorr(students_numeric_matrix)$P, sig.level = 0.05, insig = &quot;blank&quot;) "]]
